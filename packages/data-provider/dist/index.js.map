{"version":3,"file":"index.js","sources":["../src/schemas.ts","../src/types/files.ts","../src/file-config.ts","../src/config.ts","../src/parsers.ts","../src/types/assistants.ts","../src/keys.ts","../src/headers-helpers.ts","../src/api-endpoints.ts","../src/request.ts","../src/data-service.ts","../src/sse.js","../src/actions.ts","../src/createPayload.ts"],"sourcesContent":["import { z } from 'zod';\nimport type { TMessageContentParts } from './types/assistants';\nimport type { TFile } from './types/files';\n\nexport const isUUID = z.string().uuid();\n\nexport enum EModelEndpoint {\n  azureOpenAI = 'azureOpenAI',\n  openAI = 'openAI',\n  bingAI = 'bingAI',\n  chatGPTBrowser = 'chatGPTBrowser',\n  google = 'google',\n  gptPlugins = 'gptPlugins',\n  anthropic = 'anthropic',\n  assistants = 'assistants',\n  custom = 'custom',\n}\n\nexport const defaultAssistantFormValues = {\n  assistant: '',\n  id: '',\n  name: '',\n  description: '',\n  instructions: '',\n  model: 'gpt-3.5-turbo-1106',\n  functions: [],\n  code_interpreter: false,\n  retrieval: false,\n};\n\nexport const endpointSettings = {\n  [EModelEndpoint.google]: {\n    model: {\n      default: 'chat-bison',\n    },\n    maxOutputTokens: {\n      min: 1,\n      max: 2048,\n      step: 1,\n      default: 1024,\n      maxGeminiPro: 8192,\n      defaultGeminiPro: 8192,\n    },\n    temperature: {\n      min: 0,\n      max: 1,\n      step: 0.01,\n      default: 0.2,\n    },\n    topP: {\n      min: 0,\n      max: 1,\n      step: 0.01,\n      default: 0.8,\n    },\n    topK: {\n      min: 1,\n      max: 40,\n      step: 0.01,\n      default: 40,\n    },\n  },\n};\n\nconst google = endpointSettings[EModelEndpoint.google];\n\nexport const eModelEndpointSchema = z.nativeEnum(EModelEndpoint);\n\nexport const extendedModelEndpointSchema = z.union([eModelEndpointSchema, z.string()]);\n\nexport enum ImageDetail {\n  low = 'low',\n  auto = 'auto',\n  high = 'high',\n}\n\nexport const imageDetailNumeric = {\n  [ImageDetail.low]: 0,\n  [ImageDetail.auto]: 1,\n  [ImageDetail.high]: 2,\n};\n\nexport const imageDetailValue = {\n  0: ImageDetail.low,\n  1: ImageDetail.auto,\n  2: ImageDetail.high,\n};\n\nexport const eImageDetailSchema = z.nativeEnum(ImageDetail);\n\nexport const tPluginAuthConfigSchema = z.object({\n  authField: z.string(),\n  label: z.string(),\n  description: z.string(),\n});\n\nexport type TPluginAuthConfig = z.infer<typeof tPluginAuthConfigSchema>;\n\nexport const tPluginSchema = z.object({\n  name: z.string(),\n  pluginKey: z.string(),\n  description: z.string(),\n  icon: z.string(),\n  authConfig: z.array(tPluginAuthConfigSchema),\n  authenticated: z.boolean().optional(),\n  isButton: z.boolean().optional(),\n});\n\nexport type TPlugin = z.infer<typeof tPluginSchema>;\n\nexport type TInput = {\n  inputStr: string;\n};\n\nexport type TResPlugin = {\n  plugin: string;\n  input: string;\n  thought: string;\n  loading?: boolean;\n  outputs?: string;\n  latest?: string;\n  inputs?: TInput[];\n};\n\nexport const tExampleSchema = z.object({\n  input: z.object({\n    content: z.string(),\n  }),\n  output: z.object({\n    content: z.string(),\n  }),\n});\n\nexport type TExample = z.infer<typeof tExampleSchema>;\n\nexport const tAgentOptionsSchema = z.object({\n  agent: z.string(),\n  skipCompletion: z.boolean(),\n  model: z.string(),\n  temperature: z.number(),\n});\n\nexport const tMessageSchema = z.object({\n  messageId: z.string(),\n  endpoint: z.string().optional(),\n  clientId: z.string().nullable().optional(),\n  conversationId: z.string().nullable(),\n  parentMessageId: z.string().nullable(),\n  responseMessageId: z.string().nullable().optional(),\n  overrideParentMessageId: z.string().nullable().optional(),\n  bg: z.string().nullable().optional(),\n  model: z.string().nullable().optional(),\n  title: z.string().nullable().or(z.literal('New Chat')).default('New Chat'),\n  sender: z.string(),\n  text: z.string(),\n  generation: z.string().nullable().optional(),\n  isEdited: z.boolean().optional(),\n  isCreatedByUser: z.boolean(),\n  error: z.boolean(),\n  createdAt: z\n    .string()\n    .optional()\n    .default(() => new Date().toISOString()),\n  updatedAt: z\n    .string()\n    .optional()\n    .default(() => new Date().toISOString()),\n  current: z.boolean().optional(),\n  unfinished: z.boolean().optional(),\n  searchResult: z.boolean().optional(),\n  finish_reason: z.string().optional(),\n  /* assistant */\n  thread_id: z.string().optional(),\n});\n\nexport type TMessage = z.input<typeof tMessageSchema> & {\n  children?: TMessage[];\n  plugin?: TResPlugin | null;\n  plugins?: TResPlugin[];\n  content?: TMessageContentParts[];\n  files?: Partial<TFile>[];\n};\n\nexport const tConversationSchema = z.object({\n  conversationId: z.string().nullable(),\n  title: z.string().nullable().or(z.literal('New Chat')).default('New Chat'),\n  user: z.string().optional(),\n  endpoint: eModelEndpointSchema.nullable(),\n  endpointType: eModelEndpointSchema.optional(),\n  suggestions: z.array(z.string()).optional(),\n  messages: z.array(z.string()).optional(),\n  tools: z.array(tPluginSchema).optional(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n  systemMessage: z.string().nullable().optional(),\n  modelLabel: z.string().nullable().optional(),\n  examples: z.array(tExampleSchema).optional(),\n  chatGptLabel: z.string().nullable().optional(),\n  userLabel: z.string().optional(),\n  model: z.string().nullable().optional(),\n  promptPrefix: z.string().nullable().optional(),\n  temperature: z.number().optional(),\n  topP: z.number().optional(),\n  topK: z.number().optional(),\n  context: z.string().nullable().optional(),\n  top_p: z.number().optional(),\n  frequency_penalty: z.number().optional(),\n  presence_penalty: z.number().optional(),\n  jailbreak: z.boolean().optional(),\n  jailbreakConversationId: z.string().nullable().optional(),\n  conversationSignature: z.string().nullable().optional(),\n  parentMessageId: z.string().optional(),\n  clientId: z.string().nullable().optional(),\n  invocationId: z.number().nullable().optional(),\n  toneStyle: z.string().nullable().optional(),\n  maxOutputTokens: z.number().optional(),\n  agentOptions: tAgentOptionsSchema.nullable().optional(),\n  file_ids: z.array(z.string()).optional(),\n  /* vision */\n  resendImages: z.boolean().optional(),\n  imageDetail: eImageDetailSchema.optional(),\n  /* assistant */\n  assistant_id: z.string().optional(),\n  instructions: z.string().optional(),\n  /** Used to overwrite active conversation settings when saving a Preset */\n  presetOverride: z.record(z.unknown()).optional(),\n});\n\nexport const tPresetSchema = tConversationSchema\n  .omit({\n    conversationId: true,\n    createdAt: true,\n    updatedAt: true,\n    title: true,\n  })\n  .merge(\n    z.object({\n      conversationId: z.string().nullable().optional(),\n      presetId: z.string().nullable().optional(),\n      title: z.string().nullable().optional(),\n      defaultPreset: z.boolean().optional(),\n      order: z.number().optional(),\n      endpoint: extendedModelEndpointSchema.nullable(),\n    }),\n  );\n\nexport const tConvoUpdateSchema = tConversationSchema.merge(\n  z.object({\n    endpoint: extendedModelEndpointSchema.nullable(),\n  }),\n);\n\nexport const tPresetUpdateSchema = tConversationSchema.merge(\n  z.object({\n    endpoint: extendedModelEndpointSchema.nullable(),\n  }),\n);\n\nexport type TPreset = z.infer<typeof tPresetSchema>;\n\nexport type TConversation = z.infer<typeof tConversationSchema> & {\n  presetOverride?: Partial<TPreset>;\n};\n\n// type DefaultSchemaValues = Partial<typeof google>;\n\nexport const openAISchema = tConversationSchema\n  .pick({\n    model: true,\n    chatGptLabel: true,\n    promptPrefix: true,\n    temperature: true,\n    top_p: true,\n    presence_penalty: true,\n    frequency_penalty: true,\n    resendImages: true,\n    imageDetail: true,\n  })\n  .transform((obj) => ({\n    ...obj,\n    model: obj.model ?? 'gpt-3.5-turbo',\n    chatGptLabel: obj.chatGptLabel ?? null,\n    promptPrefix: obj.promptPrefix ?? null,\n    temperature: obj.temperature ?? 1,\n    top_p: obj.top_p ?? 1,\n    presence_penalty: obj.presence_penalty ?? 0,\n    frequency_penalty: obj.frequency_penalty ?? 0,\n    resendImages: obj.resendImages ?? false,\n    imageDetail: obj.imageDetail ?? ImageDetail.auto,\n  }))\n  .catch(() => ({\n    model: 'gpt-3.5-turbo',\n    chatGptLabel: null,\n    promptPrefix: null,\n    temperature: 1,\n    top_p: 1,\n    presence_penalty: 0,\n    frequency_penalty: 0,\n    resendImages: false,\n    imageDetail: ImageDetail.auto,\n  }));\n\nexport const googleSchema = tConversationSchema\n  .pick({\n    model: true,\n    modelLabel: true,\n    promptPrefix: true,\n    examples: true,\n    temperature: true,\n    maxOutputTokens: true,\n    topP: true,\n    topK: true,\n  })\n  .transform((obj) => {\n    const isGeminiPro = obj?.model?.toLowerCase()?.includes('gemini-pro');\n\n    const maxOutputTokensMax = isGeminiPro\n      ? google.maxOutputTokens.maxGeminiPro\n      : google.maxOutputTokens.max;\n    const maxOutputTokensDefault = isGeminiPro\n      ? google.maxOutputTokens.defaultGeminiPro\n      : google.maxOutputTokens.default;\n\n    let maxOutputTokens = obj.maxOutputTokens ?? maxOutputTokensDefault;\n    maxOutputTokens = Math.min(maxOutputTokens, maxOutputTokensMax);\n\n    return {\n      ...obj,\n      model: obj.model ?? google.model.default,\n      modelLabel: obj.modelLabel ?? null,\n      promptPrefix: obj.promptPrefix ?? null,\n      examples: obj.examples ?? [{ input: { content: '' }, output: { content: '' } }],\n      temperature: obj.temperature ?? google.temperature.default,\n      maxOutputTokens,\n      topP: obj.topP ?? google.topP.default,\n      topK: obj.topK ?? google.topK.default,\n    };\n  })\n  .catch(() => ({\n    model: google.model.default,\n    modelLabel: null,\n    promptPrefix: null,\n    examples: [{ input: { content: '' }, output: { content: '' } }],\n    temperature: google.temperature.default,\n    maxOutputTokens: google.maxOutputTokens.default,\n    topP: google.topP.default,\n    topK: google.topK.default,\n  }));\n\nexport const bingAISchema = tConversationSchema\n  .pick({\n    jailbreak: true,\n    systemMessage: true,\n    context: true,\n    toneStyle: true,\n    jailbreakConversationId: true,\n    conversationSignature: true,\n    clientId: true,\n    invocationId: true,\n  })\n  .transform((obj) => ({\n    ...obj,\n    model: '',\n    jailbreak: obj.jailbreak ?? false,\n    systemMessage: obj.systemMessage ?? null,\n    context: obj.context ?? null,\n    toneStyle: obj.toneStyle ?? 'creative',\n    jailbreakConversationId: obj.jailbreakConversationId ?? null,\n    conversationSignature: obj.conversationSignature ?? null,\n    clientId: obj.clientId ?? null,\n    invocationId: obj.invocationId ?? 1,\n  }))\n  .catch(() => ({\n    model: '',\n    jailbreak: false,\n    systemMessage: null,\n    context: null,\n    toneStyle: 'creative',\n    jailbreakConversationId: null,\n    conversationSignature: null,\n    clientId: null,\n    invocationId: 1,\n  }));\n\nexport const anthropicSchema = tConversationSchema\n  .pick({\n    model: true,\n    modelLabel: true,\n    promptPrefix: true,\n    temperature: true,\n    maxOutputTokens: true,\n    topP: true,\n    topK: true,\n  })\n  .transform((obj) => ({\n    ...obj,\n    model: obj.model ?? 'claude-1',\n    modelLabel: obj.modelLabel ?? null,\n    promptPrefix: obj.promptPrefix ?? null,\n    temperature: obj.temperature ?? 1,\n    maxOutputTokens: obj.maxOutputTokens ?? 4000,\n    topP: obj.topP ?? 0.7,\n    topK: obj.topK ?? 5,\n  }))\n  .catch(() => ({\n    model: 'claude-1',\n    modelLabel: null,\n    promptPrefix: null,\n    temperature: 1,\n    maxOutputTokens: 4000,\n    topP: 0.7,\n    topK: 5,\n  }));\n\nexport const chatGPTBrowserSchema = tConversationSchema\n  .pick({\n    model: true,\n  })\n  .transform((obj) => ({\n    ...obj,\n    model: obj.model ?? 'text-davinci-002-render-sha',\n  }))\n  .catch(() => ({\n    model: 'text-davinci-002-render-sha',\n  }));\n\nexport const gptPluginsSchema = tConversationSchema\n  .pick({\n    model: true,\n    chatGptLabel: true,\n    promptPrefix: true,\n    temperature: true,\n    top_p: true,\n    presence_penalty: true,\n    frequency_penalty: true,\n    tools: true,\n    agentOptions: true,\n  })\n  .transform((obj) => ({\n    ...obj,\n    model: obj.model ?? 'gpt-3.5-turbo',\n    chatGptLabel: obj.chatGptLabel ?? null,\n    promptPrefix: obj.promptPrefix ?? null,\n    temperature: obj.temperature ?? 0.8,\n    top_p: obj.top_p ?? 1,\n    presence_penalty: obj.presence_penalty ?? 0,\n    frequency_penalty: obj.frequency_penalty ?? 0,\n    tools: obj.tools ?? [],\n    agentOptions: obj.agentOptions ?? {\n      agent: 'functions',\n      skipCompletion: true,\n      model: 'gpt-3.5-turbo',\n      temperature: 0,\n    },\n  }))\n  .catch(() => ({\n    model: 'gpt-3.5-turbo',\n    chatGptLabel: null,\n    promptPrefix: null,\n    temperature: 0.8,\n    top_p: 1,\n    presence_penalty: 0,\n    frequency_penalty: 0,\n    tools: [],\n    agentOptions: {\n      agent: 'functions',\n      skipCompletion: true,\n      model: 'gpt-3.5-turbo',\n      temperature: 0,\n    },\n  }));\n\nexport function removeNullishValues<T extends object>(obj: T): T {\n  const newObj: Partial<T> = { ...obj };\n\n  (Object.keys(newObj) as Array<keyof T>).forEach((key) => {\n    if (newObj[key] === undefined || newObj[key] === null || newObj[key] === '') {\n      delete newObj[key];\n    }\n  });\n\n  return newObj as T;\n}\n\nexport const assistantSchema = tConversationSchema\n  .pick({\n    model: true,\n    assistant_id: true,\n    instructions: true,\n    promptPrefix: true,\n  })\n  .transform(removeNullishValues)\n  .catch(() => ({}));\n\nexport const compactOpenAISchema = tConversationSchema\n  .pick({\n    model: true,\n    chatGptLabel: true,\n    promptPrefix: true,\n    temperature: true,\n    top_p: true,\n    presence_penalty: true,\n    frequency_penalty: true,\n    resendImages: true,\n    imageDetail: true,\n  })\n  .transform((obj: Partial<TConversation>) => {\n    const newObj: Partial<TConversation> = { ...obj };\n    if (newObj.model === 'gpt-3.5-turbo') {\n      delete newObj.model;\n    }\n    if (newObj.temperature === 1) {\n      delete newObj.temperature;\n    }\n    if (newObj.top_p === 1) {\n      delete newObj.top_p;\n    }\n    if (newObj.presence_penalty === 0) {\n      delete newObj.presence_penalty;\n    }\n    if (newObj.frequency_penalty === 0) {\n      delete newObj.frequency_penalty;\n    }\n    if (newObj.resendImages !== true) {\n      delete newObj.resendImages;\n    }\n    if (newObj.imageDetail === ImageDetail.auto) {\n      delete newObj.imageDetail;\n    }\n\n    return removeNullishValues(newObj);\n  })\n  .catch(() => ({}));\n\nexport const compactGoogleSchema = tConversationSchema\n  .pick({\n    model: true,\n    modelLabel: true,\n    promptPrefix: true,\n    examples: true,\n    temperature: true,\n    maxOutputTokens: true,\n    topP: true,\n    topK: true,\n  })\n  .transform((obj) => {\n    const newObj: Partial<TConversation> = { ...obj };\n    if (newObj.model === google.model.default) {\n      delete newObj.model;\n    }\n    if (newObj.temperature === google.temperature.default) {\n      delete newObj.temperature;\n    }\n    if (newObj.maxOutputTokens === google.maxOutputTokens.default) {\n      delete newObj.maxOutputTokens;\n    }\n    if (newObj.topP === google.topP.default) {\n      delete newObj.topP;\n    }\n    if (newObj.topK === google.topK.default) {\n      delete newObj.topK;\n    }\n\n    return removeNullishValues(newObj);\n  })\n  .catch(() => ({}));\n\nexport const compactAnthropicSchema = tConversationSchema\n  .pick({\n    model: true,\n    modelLabel: true,\n    promptPrefix: true,\n    temperature: true,\n    maxOutputTokens: true,\n    topP: true,\n    topK: true,\n  })\n  .transform((obj) => {\n    const newObj: Partial<TConversation> = { ...obj };\n    if (newObj.model === 'claude-1') {\n      delete newObj.model;\n    }\n    if (newObj.temperature === 1) {\n      delete newObj.temperature;\n    }\n    if (newObj.maxOutputTokens === 4000) {\n      delete newObj.maxOutputTokens;\n    }\n    if (newObj.topP === 0.7) {\n      delete newObj.topP;\n    }\n    if (newObj.topK === 5) {\n      delete newObj.topK;\n    }\n\n    return removeNullishValues(newObj);\n  })\n  .catch(() => ({}));\n\nexport const compactChatGPTSchema = tConversationSchema\n  .pick({\n    model: true,\n  })\n  .transform((obj) => {\n    const newObj: Partial<TConversation> = { ...obj };\n    // model: obj.model ?? 'text-davinci-002-render-sha',\n    if (newObj.model === 'text-davinci-002-render-sha') {\n      delete newObj.model;\n    }\n\n    return removeNullishValues(newObj);\n  })\n  .catch(() => ({}));\n\nexport const compactPluginsSchema = tConversationSchema\n  .pick({\n    model: true,\n    chatGptLabel: true,\n    promptPrefix: true,\n    temperature: true,\n    top_p: true,\n    presence_penalty: true,\n    frequency_penalty: true,\n    tools: true,\n    agentOptions: true,\n  })\n  .transform((obj) => {\n    const newObj: Partial<TConversation> = { ...obj };\n    if (newObj.model === 'gpt-3.5-turbo') {\n      delete newObj.model;\n    }\n    if (newObj.chatGptLabel === null) {\n      delete newObj.chatGptLabel;\n    }\n    if (newObj.promptPrefix === null) {\n      delete newObj.promptPrefix;\n    }\n    if (newObj.temperature === 0.8) {\n      delete newObj.temperature;\n    }\n    if (newObj.top_p === 1) {\n      delete newObj.top_p;\n    }\n    if (newObj.presence_penalty === 0) {\n      delete newObj.presence_penalty;\n    }\n    if (newObj.frequency_penalty === 0) {\n      delete newObj.frequency_penalty;\n    }\n    if (newObj.tools?.length === 0) {\n      delete newObj.tools;\n    }\n\n    if (\n      newObj.agentOptions &&\n      newObj.agentOptions.agent === 'functions' &&\n      newObj.agentOptions.skipCompletion === true &&\n      newObj.agentOptions.model === 'gpt-3.5-turbo' &&\n      newObj.agentOptions.temperature === 0\n    ) {\n      delete newObj.agentOptions;\n    }\n\n    return removeNullishValues(newObj);\n  })\n  .catch(() => ({}));\n\n// const createGoogleSchema = (customGoogle: DefaultSchemaValues) => {\n//   const defaults = { ...google, ...customGoogle };\n//   return tConversationSchema\n//     .pick({\n//       model: true,\n//       modelLabel: true,\n//       promptPrefix: true,\n//       examples: true,\n//       temperature: true,\n//       maxOutputTokens: true,\n//       topP: true,\n//       topK: true,\n//     })\n//     .transform((obj) => {\n//       const isGeminiPro = obj?.model?.toLowerCase()?.includes('gemini-pro');\n\n//       const maxOutputTokensMax = isGeminiPro\n//         ? defaults.maxOutputTokens.maxGeminiPro\n//         : defaults.maxOutputTokens.max;\n//       const maxOutputTokensDefault = isGeminiPro\n//         ? defaults.maxOutputTokens.defaultGeminiPro\n//         : defaults.maxOutputTokens.default;\n\n//       let maxOutputTokens = obj.maxOutputTokens ?? maxOutputTokensDefault;\n//       maxOutputTokens = Math.min(maxOutputTokens, maxOutputTokensMax);\n\n//       return {\n//         ...obj,\n//         model: obj.model ?? defaults.model.default,\n//         modelLabel: obj.modelLabel ?? null,\n//         promptPrefix: obj.promptPrefix ?? null,\n//         examples: obj.examples ?? [{ input: { content: '' }, output: { content: '' } }],\n//         temperature: obj.temperature ?? defaults.temperature.default,\n//         maxOutputTokens,\n//         topP: obj.topP ?? defaults.topP.default,\n//         topK: obj.topK ?? defaults.topK.default,\n//       };\n//     })\n//     .catch(() => ({\n//       model: defaults.model.default,\n//       modelLabel: null,\n//       promptPrefix: null,\n//       examples: [{ input: { content: '' }, output: { content: '' } }],\n//       temperature: defaults.temperature.default,\n//       maxOutputTokens: defaults.maxOutputTokens.default,\n//       topP: defaults.topP.default,\n//       topK: defaults.topK.default,\n//     }));\n// };\n","export enum FileSources {\n  local = 'local',\n  firebase = 'firebase',\n  openai = 'openai',\n  s3 = 's3',\n}\n\nexport enum FileContext {\n  avatar = 'avatar',\n  unknown = 'unknown',\n  assistants = 'assistants',\n  image_generation = 'image_generation',\n  assistants_output = 'assistants_output',\n  message_attachment = 'message_attachment',\n}\n\nexport type EndpointFileConfig = {\n  disabled?: boolean;\n  fileLimit?: number;\n  fileSizeLimit?: number;\n  totalSizeLimit?: number;\n  supportedMimeTypes?: RegExp[];\n};\n\nexport type FileConfig = {\n  endpoints: {\n    [key: string]: EndpointFileConfig;\n  };\n  serverFileSizeLimit?: number;\n  avatarSizeLimit?: number;\n  checkType?: (fileType: string, supportedTypes: RegExp[]) => boolean;\n};\n\nexport type TFile = {\n  _id?: string;\n  __v?: number;\n  user: string;\n  conversationId?: string;\n  message?: string;\n  file_id: string;\n  temp_file_id?: string;\n  bytes: number;\n  filename: string;\n  filepath: string;\n  object: 'file';\n  type: string;\n  usage: number;\n  context?: FileContext;\n  source?: FileSources;\n  width?: number;\n  height?: number;\n  expiresAt?: string | Date;\n  preview?: string;\n  createdAt?: string | Date;\n  updatedAt?: string | Date;\n};\n\nexport type TFileUpload = TFile & {\n  temp_file_id: string;\n};\n\nexport type AvatarUploadResponse = {\n  url: string;\n};\n\nexport type UploadMutationOptions = {\n  onSuccess?: (data: TFileUpload, variables: FormData, context?: unknown) => void;\n  onMutate?: (variables: FormData) => void | Promise<unknown>;\n  onError?: (error: unknown, variables: FormData, context?: unknown) => void;\n};\n\nexport type UploadAvatarOptions = {\n  onSuccess?: (data: AvatarUploadResponse, variables: FormData, context?: unknown) => void;\n  onMutate?: (variables: FormData) => void | Promise<unknown>;\n  onError?: (error: unknown, variables: FormData, context?: unknown) => void;\n};\n\nexport type DeleteFilesResponse = {\n  message: string;\n  result: Record<string, unknown>;\n};\n\nexport type BatchFile = {\n  file_id: string;\n  filepath: string;\n  source: FileSources;\n};\n\nexport type DeleteFilesBody = {\n  files: BatchFile[];\n  assistant_id?: string;\n};\n\nexport type DeleteMutationOptions = {\n  onSuccess?: (data: DeleteFilesResponse, variables: DeleteFilesBody, context?: unknown) => void;\n  onMutate?: (variables: DeleteFilesBody) => void | Promise<unknown>;\n  onError?: (error: unknown, variables: DeleteFilesBody, context?: unknown) => void;\n};\n","/* eslint-disable max-len */\nimport { z } from 'zod';\nimport { EModelEndpoint } from './schemas';\nimport type { FileConfig, EndpointFileConfig } from './types/files';\n\nexport const supportsFiles = {\n  [EModelEndpoint.openAI]: true,\n  [EModelEndpoint.google]: true,\n  [EModelEndpoint.assistants]: true,\n  [EModelEndpoint.azureOpenAI]: true,\n  [EModelEndpoint.custom]: true,\n};\n\nexport const excelFileTypes = [\n  'application/vnd.ms-excel',\n  'application/msexcel',\n  'application/x-msexcel',\n  'application/x-ms-excel',\n  'application/x-excel',\n  'application/x-dos_ms_excel',\n  'application/xls',\n  'application/x-xls',\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n];\n\nexport const fullMimeTypesList = [\n  'text/x-c',\n  'text/x-c++',\n  'application/csv',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  'text/html',\n  'text/x-java',\n  'application/json',\n  'text/markdown',\n  'application/pdf',\n  'text/x-php',\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  'text/x-python',\n  'text/x-script.python',\n  'text/x-ruby',\n  'text/x-tex',\n  'text/plain',\n  'text/css',\n  'image/jpeg',\n  'text/javascript',\n  'image/gif',\n  'image/png',\n  'application/x-tar',\n  'application/typescript',\n  'application/xml',\n  'application/zip',\n  ...excelFileTypes,\n];\n\nexport const codeInterpreterMimeTypesList = [\n  'text/x-c',\n  'text/x-c++',\n  'application/csv',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  'text/html',\n  'text/x-java',\n  'application/json',\n  'text/markdown',\n  'application/pdf',\n  'text/x-php',\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  'text/x-python',\n  'text/x-script.python',\n  'text/x-ruby',\n  'text/x-tex',\n  'text/plain',\n  'text/css',\n  'image/jpeg',\n  'text/javascript',\n  'image/gif',\n  'image/png',\n  'application/x-tar',\n  'application/typescript',\n  'application/xml',\n  'application/zip',\n  ...excelFileTypes,\n];\n\nexport const retrievalMimeTypesList = [\n  'text/x-c',\n  'text/x-c++',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  'text/html',\n  'text/x-java',\n  'application/json',\n  'text/markdown',\n  'application/pdf',\n  'text/x-php',\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  'text/x-python',\n  'text/x-script.python',\n  'text/x-ruby',\n  'text/x-tex',\n  'text/plain',\n];\n\nexport const imageExtRegex = /\\.(jpg|jpeg|png|gif|webp)$/i;\n\nexport const excelMimeTypes =\n  /^application\\/(vnd\\.ms-excel|msexcel|x-msexcel|x-ms-excel|x-excel|x-dos_ms_excel|xls|x-xls|vnd\\.openxmlformats-officedocument\\.spreadsheetml\\.sheet)$/;\n\nexport const textMimeTypes =\n  /^(text\\/(x-c|x-c\\+\\+|x-java|html|markdown|x-php|x-python|x-script\\.python|x-ruby|x-tex|plain|css|javascript|csv))$/;\n\nexport const applicationMimeTypes =\n  /^(application\\/(csv|json|pdf|x-tar|typescript|vnd\\.openxmlformats-officedocument\\.(wordprocessingml\\.document|presentationml\\.presentation|spreadsheetml\\.sheet)|xml|zip))$/;\n\nexport const imageMimeTypes = /^image\\/(jpeg|gif|png|webp)$/;\n\nexport const supportedMimeTypes = [\n  textMimeTypes,\n  excelMimeTypes,\n  applicationMimeTypes,\n  imageMimeTypes,\n];\n\nexport const codeInterpreterMimeTypes = [\n  textMimeTypes,\n  excelMimeTypes,\n  applicationMimeTypes,\n  imageMimeTypes,\n];\n\nexport const retrievalMimeTypes = [\n  /^(text\\/(x-c|x-c\\+\\+|html|x-java|markdown|x-php|x-python|x-script\\.python|x-ruby|x-tex|plain))$/,\n  /^(application\\/(json|pdf|vnd\\.openxmlformats-officedocument\\.(wordprocessingml\\.document|presentationml\\.presentation)))$/,\n];\n\nexport const megabyte = 1024 * 1024;\n/** Helper function to get megabytes value */\nexport const mbToBytes = (mb: number): number => mb * megabyte;\n\nexport const fileConfig = {\n  endpoints: {\n    [EModelEndpoint.assistants]: {\n      fileLimit: 10,\n      fileSizeLimit: mbToBytes(512),\n      totalSizeLimit: mbToBytes(512),\n      supportedMimeTypes,\n      disabled: false,\n    },\n    default: {\n      fileLimit: 10,\n      fileSizeLimit: mbToBytes(20),\n      totalSizeLimit: mbToBytes(25),\n      supportedMimeTypes: [imageMimeTypes],\n      disabled: false,\n    },\n  },\n  serverFileSizeLimit: mbToBytes(512),\n  avatarSizeLimit: mbToBytes(2),\n  checkType: function (fileType: string, supportedTypes: RegExp[] = supportedMimeTypes) {\n    return supportedTypes.some((regex) => regex.test(fileType));\n  },\n};\n\nconst supportedMimeTypesSchema = z\n  .array(z.any())\n  .optional()\n  .refine(\n    (mimeTypes) => {\n      if (!mimeTypes) {\n        return true;\n      }\n      return mimeTypes.every(\n        (mimeType) => mimeType instanceof RegExp || typeof mimeType === 'string',\n      );\n    },\n    {\n      message: 'Each mimeType must be a string or a RegExp object.',\n    },\n  );\n\nexport const endpointFileConfigSchema = z.object({\n  disabled: z.boolean().optional(),\n  fileLimit: z.number().min(0).optional(),\n  fileSizeLimit: z.number().min(0).optional(),\n  totalSizeLimit: z.number().min(0).optional(),\n  supportedMimeTypes: supportedMimeTypesSchema.optional(),\n});\n\nexport const fileConfigSchema = z.object({\n  endpoints: z.record(endpointFileConfigSchema).optional(),\n  serverFileSizeLimit: z.number().min(0).optional(),\n  avatarSizeLimit: z.number().min(0).optional(),\n});\n\n/** Helper function to safely convert string patterns to RegExp objects */\nexport const convertStringsToRegex = (patterns: string[]): RegExp[] =>\n  patterns.reduce((acc: RegExp[], pattern) => {\n    try {\n      const regex = new RegExp(pattern);\n      acc.push(regex);\n    } catch (error) {\n      console.error(`Invalid regex pattern \"${pattern}\" skipped.`);\n    }\n    return acc;\n  }, []);\n\nexport function mergeFileConfig(dynamic: z.infer<typeof fileConfigSchema> | undefined): FileConfig {\n  const mergedConfig = fileConfig as FileConfig;\n  if (!dynamic) {\n    return mergedConfig;\n  }\n\n  if (dynamic.serverFileSizeLimit !== undefined) {\n    mergedConfig.serverFileSizeLimit = mbToBytes(dynamic.serverFileSizeLimit);\n  }\n\n  if (dynamic.avatarSizeLimit !== undefined) {\n    mergedConfig.avatarSizeLimit = mbToBytes(dynamic.avatarSizeLimit);\n  }\n\n  if (!dynamic.endpoints) {\n    return mergedConfig;\n  }\n\n  for (const key in dynamic.endpoints) {\n    const dynamicEndpoint = (dynamic.endpoints as Record<string, EndpointFileConfig>)[key];\n\n    if (!mergedConfig.endpoints[key]) {\n      mergedConfig.endpoints[key] = {};\n    }\n\n    const mergedEndpoint = mergedConfig.endpoints[key];\n\n    if (dynamicEndpoint.disabled === true) {\n      mergedEndpoint.disabled = true;\n      mergedEndpoint.fileLimit = 0;\n      mergedEndpoint.fileSizeLimit = 0;\n      mergedEndpoint.totalSizeLimit = 0;\n      mergedEndpoint.supportedMimeTypes = [];\n      continue;\n    }\n\n    if (dynamicEndpoint.fileSizeLimit !== undefined) {\n      mergedEndpoint.fileSizeLimit = mbToBytes(dynamicEndpoint.fileSizeLimit);\n    }\n\n    if (dynamicEndpoint.totalSizeLimit !== undefined) {\n      mergedEndpoint.totalSizeLimit = mbToBytes(dynamicEndpoint.totalSizeLimit);\n    }\n\n    const configKeys = ['fileLimit'] as const;\n    configKeys.forEach((field) => {\n      if (dynamicEndpoint[field] !== undefined) {\n        mergedEndpoint[field] = dynamicEndpoint[field];\n      }\n    });\n\n    if (dynamicEndpoint.supportedMimeTypes) {\n      mergedEndpoint.supportedMimeTypes = convertStringsToRegex(\n        dynamicEndpoint.supportedMimeTypes as unknown as string[],\n      );\n    }\n  }\n\n  return mergedConfig;\n}\n","/* eslint-disable max-len */\nimport { z } from 'zod';\nimport { EModelEndpoint, eModelEndpointSchema } from './schemas';\nimport { fileConfigSchema } from './file-config';\nimport { FileSources } from './types/files';\n\nexport const defaultSocialLogins = ['google', 'facebook', 'openid', 'github', 'discord'];\n\nexport const fileSourceSchema = z.nativeEnum(FileSources);\n\nexport const assistantEndpointSchema = z.object({\n  /* assistants specific */\n  disableBuilder: z.boolean().optional(),\n  pollIntervalMs: z.number().optional(),\n  timeoutMs: z.number().optional(),\n  supportedIds: z.array(z.string()).min(1).optional(),\n  excludedIds: z.array(z.string()).min(1).optional(),\n  /* general */\n  apiKey: z.string().optional(),\n  baseURL: z.string().optional(),\n  models: z\n    .object({\n      default: z.array(z.string()).min(1),\n      fetch: z.boolean().optional(),\n      userIdQuery: z.boolean().optional(),\n    })\n    .optional(),\n  titleConvo: z.boolean().optional(),\n  titleMethod: z.union([z.literal('completion'), z.literal('functions')]).optional(),\n  titleModel: z.string().optional(),\n  headers: z.record(z.any()).optional(),\n});\n\nexport type TAssistantEndpoint = z.infer<typeof assistantEndpointSchema>;\n\nexport const endpointSchema = z.object({\n  name: z.string().refine((value) => !eModelEndpointSchema.safeParse(value).success, {\n    message: `Value cannot be one of the default endpoint (EModelEndpoint) values: ${Object.values(\n      EModelEndpoint,\n    ).join(', ')}`,\n  }),\n  apiKey: z.string(),\n  baseURL: z.string(),\n  models: z.object({\n    default: z.array(z.string()).min(1),\n    fetch: z.boolean().optional(),\n    userIdQuery: z.boolean().optional(),\n  }),\n  titleConvo: z.boolean().optional(),\n  titleMethod: z.union([z.literal('completion'), z.literal('functions')]).optional(),\n  titleModel: z.string().optional(),\n  summarize: z.boolean().optional(),\n  summaryModel: z.string().optional(),\n  forcePrompt: z.boolean().optional(),\n  modelDisplayLabel: z.string().optional(),\n  headers: z.record(z.any()).optional(),\n  addParams: z.record(z.any()).optional(),\n  dropParams: z.array(z.string()).optional(),\n});\n\nexport const rateLimitSchema = z.object({\n  fileUploads: z\n    .object({\n      ipMax: z.number().optional(),\n      ipWindowInMinutes: z.number().optional(),\n      userMax: z.number().optional(),\n      userWindowInMinutes: z.number().optional(),\n    })\n    .optional(),\n});\n\nexport const configSchema = z.object({\n  version: z.string(),\n  cache: z.boolean(),\n  fileStrategy: fileSourceSchema.optional(),\n  registration: z\n    .object({\n      socialLogins: z.array(z.string()).optional(),\n      allowedDomains: z.array(z.string()).optional(),\n    })\n    .optional(),\n  rateLimits: rateLimitSchema.optional(),\n  fileConfig: fileConfigSchema.optional(),\n  endpoints: z\n    .object({\n      [EModelEndpoint.assistants]: assistantEndpointSchema.optional(),\n      custom: z.array(endpointSchema.partial()).optional(),\n    })\n    .strict()\n    .refine((data) => Object.keys(data).length > 0, {\n      message: 'At least one `endpoints` field must be provided.',\n    })\n    .optional(),\n});\n\nexport type TCustomConfig = z.infer<typeof configSchema>;\n\nexport enum KnownEndpoints {\n  mistral = 'mistral',\n  openrouter = 'openrouter',\n}\n\nexport const defaultEndpoints: EModelEndpoint[] = [\n  EModelEndpoint.openAI,\n  EModelEndpoint.assistants,\n  EModelEndpoint.azureOpenAI,\n  EModelEndpoint.bingAI,\n  EModelEndpoint.chatGPTBrowser,\n  EModelEndpoint.gptPlugins,\n  EModelEndpoint.google,\n  EModelEndpoint.anthropic,\n  EModelEndpoint.custom,\n];\n\nexport const alternateName = {\n  [EModelEndpoint.openAI]: 'OpenAI',\n  [EModelEndpoint.assistants]: 'Assistants',\n  [EModelEndpoint.azureOpenAI]: 'Azure OpenAI',\n  [EModelEndpoint.bingAI]: 'IntelliumGPT',\n  [EModelEndpoint.chatGPTBrowser]: 'ChatGPT',\n  [EModelEndpoint.gptPlugins]: 'Plugins',\n  [EModelEndpoint.google]: 'Google',\n  [EModelEndpoint.anthropic]: 'Anthropic',\n  [EModelEndpoint.custom]: 'Custom',\n};\n\nexport const defaultModels = {\n  [EModelEndpoint.assistants]: [\n    'gpt-3.5-turbo-0125',\n    'gpt-4-0125-preview',\n    'gpt-4-turbo-preview',\n    'gpt-4-1106-preview',\n    'gpt-3.5-turbo-1106',\n    'gpt-3.5-turbo-16k-0613',\n    'gpt-3.5-turbo-16k',\n    'gpt-3.5-turbo',\n    'gpt-4',\n    'gpt-4-0314',\n    'gpt-4-32k-0314',\n    'gpt-4-0613',\n    'gpt-3.5-turbo-0613',\n  ],\n  [EModelEndpoint.google]: [\n    'gemini-pro',\n    'gemini-pro-vision',\n    'chat-bison',\n    'chat-bison-32k',\n    'codechat-bison',\n    'codechat-bison-32k',\n    'text-bison',\n    'text-bison-32k',\n    'text-unicorn',\n    'code-gecko',\n    'code-bison',\n    'code-bison-32k',\n  ],\n  [EModelEndpoint.anthropic]: [\n    'claude-2.1',\n    'claude-2',\n    'claude-1.2',\n    'claude-1',\n    'claude-1-100k',\n    'claude-instant-1',\n    'claude-instant-1-100k',\n  ],\n  [EModelEndpoint.openAI]: [\n    'gpt-3.5-turbo-0125',\n    'gpt-3.5-turbo-16k-0613',\n    'gpt-3.5-turbo-16k',\n    'gpt-4-turbo-preview',\n    'gpt-4-0125-preview',\n    'gpt-4-1106-preview',\n    'gpt-3.5-turbo',\n    'gpt-3.5-turbo-1106',\n    'gpt-4-vision-preview',\n    'gpt-4',\n    'gpt-3.5-turbo-instruct-0914',\n    'gpt-3.5-turbo-0613',\n    'gpt-3.5-turbo-0301',\n    'gpt-3.5-turbo-instruct',\n    'gpt-4-0613',\n    'text-davinci-003',\n    'gpt-4-0314',\n  ],\n};\n\nexport const supportsRetrieval = new Set([\n  'gpt-3.5-turbo-0125',\n  'gpt-4-0125-preview',\n  'gpt-4-turbo-preview',\n  'gpt-4-1106-preview',\n  'gpt-3.5-turbo-1106',\n]);\n\nexport const EndpointURLs: { [key in EModelEndpoint]: string } = {\n  [EModelEndpoint.openAI]: `/api/ask/${EModelEndpoint.openAI}`,\n  [EModelEndpoint.bingAI]: `/api/ask/${EModelEndpoint.bingAI}`,\n  [EModelEndpoint.google]: `/api/ask/${EModelEndpoint.google}`,\n  [EModelEndpoint.custom]: `/api/ask/${EModelEndpoint.custom}`,\n  [EModelEndpoint.anthropic]: `/api/ask/${EModelEndpoint.anthropic}`,\n  [EModelEndpoint.gptPlugins]: `/api/ask/${EModelEndpoint.gptPlugins}`,\n  [EModelEndpoint.azureOpenAI]: `/api/ask/${EModelEndpoint.azureOpenAI}`,\n  [EModelEndpoint.chatGPTBrowser]: `/api/ask/${EModelEndpoint.chatGPTBrowser}`,\n  [EModelEndpoint.assistants]: '/api/assistants/chat',\n};\n\nexport const modularEndpoints = new Set<EModelEndpoint | string>([\n  EModelEndpoint.gptPlugins,\n  EModelEndpoint.anthropic,\n  EModelEndpoint.google,\n  EModelEndpoint.openAI,\n  EModelEndpoint.azureOpenAI,\n  EModelEndpoint.custom,\n]);\n\nexport const supportsBalanceCheck = {\n  [EModelEndpoint.openAI]: true,\n  [EModelEndpoint.azureOpenAI]: true,\n  [EModelEndpoint.gptPlugins]: true,\n  [EModelEndpoint.custom]: true,\n};\n\nexport const visionModels = ['gpt-4-vision', 'llava-13b', 'gemini-pro-vision'];\n\nexport function validateVisionModel(\n  model: string | undefined,\n  additionalModels: string[] | undefined = [],\n) {\n  if (!model) {\n    return false;\n  }\n\n  return visionModels.concat(additionalModels).some((visionModel) => model.includes(visionModel));\n}\n\nexport const imageGenTools = new Set(['dalle', 'dall-e', 'stable-diffusion']);\n\n/**\n * Enum for cache keys.\n */\nexport enum CacheKeys {\n  /**\n   * Key for the config store namespace.\n   */\n  CONFIG_STORE = 'configStore',\n  /**\n   * Key for the plugins cache.\n   */\n  PLUGINS = 'plugins',\n  /**\n   * Key for the title generation cache.\n   */\n  GEN_TITLE = 'genTitle',\n  /**\n  /**\n   * Key for the tools cache.\n   */\n  TOOLS = 'tools',\n  /**\n   * Key for the model config cache.\n   */\n  MODELS_CONFIG = 'modelsConfig',\n  /**\n   * Key for the model queries cache.\n   */\n  MODEL_QUERIES = 'modelQueries',\n  /**\n   * Key for the default endpoint config cache.\n   */\n  ENDPOINT_CONFIG = 'endpointsConfig',\n  /**\n   * Key for accessing the model token config cache.\n   */\n  TOKEN_CONFIG = 'tokenConfig',\n  /**\n   * Key for the custom config cache.\n   */\n  CUSTOM_CONFIG = 'customConfig',\n  /**\n   * Key for accessing Abort Keys\n   */\n  ABORT_KEYS = 'abortKeys',\n  /**\n   * Key for the override config cache.\n   */\n  OVERRIDE_CONFIG = 'overrideConfig',\n  /**\n   * Key for accessing File Upload Violations (exceeding limit).\n   */\n  FILE_UPLOAD_LIMIT = 'file_upload_limit',\n}\n\n/**\n * Enum for authentication keys.\n */\nexport enum AuthKeys {\n  /**\n   * Key for the Service Account to use Vertex AI.\n   */\n  GOOGLE_SERVICE_KEY = 'GOOGLE_SERVICE_KEY',\n  /**\n   * API key to use Google Generative AI.\n   */\n  GOOGLE_API_KEY = 'GOOGLE_API_KEY',\n}\n\n/**\n * Enum for Image Detail Cost.\n *\n * **Low Res Fixed Cost:** `85`\n *\n * **High Res Calculation:**\n *\n * Number of `512px` Tiles * `170` + `85` (Additional Cost)\n */\nexport enum ImageDetailCost {\n  /**\n   * Low resolution is a fixed value.\n   */\n  LOW = 85,\n  /**\n   * High resolution Cost Per Tile\n   */\n  HIGH = 170,\n  /**\n   * Additional Cost added to High Resolution Total Cost\n   */\n  ADDITIONAL = 85,\n}\n\n/**\n * Tab values for Settings Dialog\n */\nexport enum SettingsTabValues {\n  /**\n   * Tab for General Settings\n   */\n  GENERAL = 'general',\n  /**\n   * Tab for Beta Features\n   */\n  BETA = 'beta',\n  /**\n   * Tab for Data Controls\n   */\n  DATA = 'data',\n  /**\n   * Tab for Account Settings\n   */\n  ACCOUNT = 'account',\n}\n\n/**\n * Enum for app-wide constants\n */\nexport enum Constants {\n  /**\n   * Key for the app's version.\n   */\n  VERSION = 'v0.6.10',\n  /**\n   * Key for the Custom Config's version (librechat.yaml).\n   */\n  CONFIG_VERSION = '1.0.3',\n  /**\n   * Standard value for the first message's `parentMessageId` value, to indicate no parent exists.\n   */\n  NO_PARENT = '00000000-0000-0000-0000-000000000000',\n}\n\nexport const defaultOrderQuery: {\n  order: 'asc';\n} = {\n  order: 'asc',\n};\n","import type { TConversation, TPreset } from './schemas';\nimport type { TEndpointOption } from './types';\nimport {\n  EModelEndpoint,\n  openAISchema,\n  googleSchema,\n  bingAISchema,\n  anthropicSchema,\n  chatGPTBrowserSchema,\n  gptPluginsSchema,\n  assistantSchema,\n  compactOpenAISchema,\n  compactGoogleSchema,\n  compactAnthropicSchema,\n  compactChatGPTSchema,\n  compactPluginsSchema,\n} from './schemas';\nimport { alternateName } from './config';\n\ntype EndpointSchema =\n  | typeof openAISchema\n  | typeof googleSchema\n  | typeof bingAISchema\n  | typeof anthropicSchema\n  | typeof chatGPTBrowserSchema\n  | typeof gptPluginsSchema\n  | typeof assistantSchema;\n\nconst endpointSchemas: Record<EModelEndpoint, EndpointSchema> = {\n  [EModelEndpoint.openAI]: openAISchema,\n  [EModelEndpoint.azureOpenAI]: openAISchema,\n  [EModelEndpoint.custom]: openAISchema,\n  [EModelEndpoint.google]: googleSchema,\n  [EModelEndpoint.bingAI]: bingAISchema,\n  [EModelEndpoint.anthropic]: anthropicSchema,\n  [EModelEndpoint.chatGPTBrowser]: chatGPTBrowserSchema,\n  [EModelEndpoint.gptPlugins]: gptPluginsSchema,\n  [EModelEndpoint.assistants]: assistantSchema,\n};\n\n// const schemaCreators: Record<EModelEndpoint, (customSchema: DefaultSchemaValues) => EndpointSchema> = {\n//   [EModelEndpoint.google]: createGoogleSchema,\n// };\n\nexport function getFirstDefinedValue(possibleValues: string[]) {\n  let returnValue;\n  for (const value of possibleValues) {\n    if (value) {\n      returnValue = value;\n      break;\n    }\n  }\n  return returnValue;\n}\n\nexport type TPossibleValues = {\n  models: string[];\n  secondaryModels?: string[];\n};\n\nexport const parseConvo = ({\n  endpoint,\n  endpointType,\n  conversation,\n  possibleValues,\n}: {\n  endpoint: EModelEndpoint;\n  endpointType?: EModelEndpoint;\n  conversation: Partial<TConversation | TPreset>;\n  possibleValues?: TPossibleValues;\n  // TODO: POC for default schema\n  // defaultSchema?: Partial<EndpointSchema>,\n}) => {\n  let schema = endpointSchemas[endpoint];\n\n  if (!schema && !endpointType) {\n    throw new Error(`Unknown endpoint: ${endpoint}`);\n  } else if (!schema && endpointType) {\n    schema = endpointSchemas[endpointType];\n  }\n\n  // if (defaultSchema && schemaCreators[endpoint]) {\n  //   schema = schemaCreators[endpoint](defaultSchema);\n  // }\n\n  const convo = schema.parse(conversation) as TConversation;\n  const { models, secondaryModels } = possibleValues ?? {};\n\n  if (models && convo) {\n    convo.model = getFirstDefinedValue(models) ?? convo.model;\n  }\n\n  if (secondaryModels && convo.agentOptions) {\n    convo.agentOptions.model = getFirstDefinedValue(secondaryModels) ?? convo.agentOptions.model;\n  }\n\n  return convo;\n};\n\nexport const getResponseSender = (endpointOption: TEndpointOption): string => {\n  const { model, endpoint, endpointType, modelDisplayLabel, chatGptLabel, modelLabel, jailbreak } =\n    endpointOption;\n\n  if (\n    [\n      EModelEndpoint.openAI,\n      EModelEndpoint.azureOpenAI,\n      EModelEndpoint.gptPlugins,\n      EModelEndpoint.chatGPTBrowser,\n    ].includes(endpoint)\n  ) {\n    if (chatGptLabel) {\n      return chatGptLabel;\n    } else if (model && model.includes('gpt-3')) {\n      return 'GPT-3.5';\n    } else if (model && model.includes('gpt-4')) {\n      return 'GPT-4';\n    } else if (model && model.includes('mistral')) {\n      return 'Mistral';\n    }\n    return alternateName[endpoint] ?? 'ChatGPT';\n  }\n\n  if (endpoint === EModelEndpoint.bingAI) {\n    return jailbreak ? 'IntGPT' : 'IntGPT Pro';\n  }\n\n  if (endpoint === EModelEndpoint.anthropic) {\n    return modelLabel ?? 'Claude';\n  }\n\n  if (endpoint === EModelEndpoint.google) {\n    if (modelLabel) {\n      return modelLabel;\n    } else if (model && model.includes('gemini')) {\n      return 'Gemini';\n    } else if (model && model.includes('code')) {\n      return 'Codey';\n    }\n\n    return 'PaLM2';\n  }\n\n  if (endpoint === EModelEndpoint.custom || endpointType === EModelEndpoint.custom) {\n    if (modelLabel) {\n      return modelLabel;\n    } else if (chatGptLabel) {\n      return chatGptLabel;\n    } else if (model && model.includes('mistral')) {\n      return 'Mistral';\n    } else if (model && model.includes('gpt-3')) {\n      return 'GPT-3.5';\n    } else if (model && model.includes('gpt-4')) {\n      return 'GPT-4';\n    } else if (modelDisplayLabel) {\n      return modelDisplayLabel;\n    }\n\n    return 'AI';\n  }\n\n  return '';\n};\n\ntype CompactEndpointSchema =\n  | typeof compactOpenAISchema\n  | typeof assistantSchema\n  | typeof compactGoogleSchema\n  | typeof bingAISchema\n  | typeof compactAnthropicSchema\n  | typeof compactChatGPTSchema\n  | typeof compactPluginsSchema;\n\nconst compactEndpointSchemas: Record<string, CompactEndpointSchema> = {\n  [EModelEndpoint.openAI]: compactOpenAISchema,\n  [EModelEndpoint.azureOpenAI]: compactOpenAISchema,\n  [EModelEndpoint.custom]: compactOpenAISchema,\n  [EModelEndpoint.assistants]: assistantSchema,\n  [EModelEndpoint.google]: compactGoogleSchema,\n  /* BingAI needs all fields */\n  [EModelEndpoint.bingAI]: bingAISchema,\n  [EModelEndpoint.anthropic]: compactAnthropicSchema,\n  [EModelEndpoint.chatGPTBrowser]: compactChatGPTSchema,\n  [EModelEndpoint.gptPlugins]: compactPluginsSchema,\n};\n\nexport const parseCompactConvo = ({\n  endpoint,\n  endpointType,\n  conversation,\n  possibleValues,\n}: {\n  endpoint?: EModelEndpoint;\n  endpointType?: EModelEndpoint;\n  conversation: Partial<TConversation | TPreset>;\n  possibleValues?: TPossibleValues;\n  // TODO: POC for default schema\n  // defaultSchema?: Partial<EndpointSchema>,\n}) => {\n  if (!endpoint) {\n    throw new Error(`undefined endpoint: ${endpoint}`);\n  }\n\n  let schema = compactEndpointSchemas[endpoint];\n\n  if (!schema && !endpointType) {\n    throw new Error(`Unknown endpoint: ${endpoint}`);\n  } else if (!schema && endpointType) {\n    schema = compactEndpointSchemas[endpointType];\n  }\n\n  const convo = schema.parse(conversation) as TConversation;\n  // const { models, secondaryModels } = possibleValues ?? {};\n  const { models } = possibleValues ?? {};\n\n  if (models && convo) {\n    convo.model = getFirstDefinedValue(models) ?? convo.model;\n  }\n\n  // if (secondaryModels && convo.agentOptions) {\n  //   convo.agentOptionmodel = getFirstDefinedValue(secondaryModels) ?? convo.agentOptionmodel;\n  // }\n\n  return convo;\n};\n","import type { OpenAPIV3 } from 'openapi-types';\n\nexport type Schema = OpenAPIV3.SchemaObject & { description?: string };\nexport type Reference = OpenAPIV3.ReferenceObject & { description?: string };\n\nexport type Metadata = {\n  [key: string]: unknown;\n};\n\nexport enum Tools {\n  code_interpreter = 'code_interpreter',\n  retrieval = 'retrieval',\n  function = 'function',\n}\n\nexport type Tool = {\n  [type: string]: Tools;\n};\n\nexport type FunctionTool = {\n  type: Tools;\n  function?: {\n    description: string;\n    name: string;\n    parameters: Record<string, unknown>;\n  };\n};\n\nexport type Assistant = {\n  id: string;\n  created_at: number;\n  description: string | null;\n  file_ids: string[];\n  instructions: string | null;\n  metadata: Metadata | null;\n  model: string;\n  name: string | null;\n  object: string;\n  tools: FunctionTool[];\n};\n\nexport type AssistantCreateParams = {\n  model: string;\n  description?: string | null;\n  file_ids?: string[];\n  instructions?: string | null;\n  metadata?: Metadata | null;\n  name?: string | null;\n  tools?: Array<FunctionTool | string>;\n};\n\nexport type AssistantUpdateParams = {\n  model?: string;\n  description?: string | null;\n  file_ids?: string[];\n  instructions?: string | null;\n  metadata?: Metadata | null;\n  name?: string | null;\n  tools?: Array<FunctionTool | string>;\n};\n\nexport type AssistantListParams = {\n  limit?: number;\n  before?: string | null;\n  after?: string | null;\n  order?: 'asc' | 'desc';\n};\n\nexport type AssistantListResponse = {\n  object: string;\n  data: Assistant[];\n  first_id: string;\n  last_id: string;\n  has_more: boolean;\n};\n\nexport type File = {\n  file_id: string;\n  id?: string;\n  temp_file_id?: string;\n  bytes: number;\n  created_at: number;\n  filename: string;\n  object: string;\n  purpose: 'fine-tune' | 'fine-tune-results' | 'assistants' | 'assistants_output';\n};\n\n/**\n * Details of the Code Interpreter tool call the run step was involved in.\n * Includes the tool call ID, the code interpreter definition, and the type of tool call.\n */\nexport type CodeToolCall = {\n  id: string; // The ID of the tool call.\n  code_interpreter: {\n    input: string; // The input to the Code Interpreter tool call.\n    outputs: Array<Record<string, unknown>>; // The outputs from the Code Interpreter tool call.\n  };\n  type: 'code_interpreter'; // The type of tool call, always 'code_interpreter'.\n};\n\n/**\n * Details of a Function tool call the run step was involved in.\n * Includes the tool call ID, the function definition, and the type of tool call.\n */\nexport type FunctionToolCall = {\n  id: string; // The ID of the tool call object.\n  function: {\n    arguments: string; // The arguments passed to the function.\n    name: string; // The name of the function.\n    output: string | null; // The output of the function, null if not submitted.\n  };\n  type: 'function'; // The type of tool call, always 'function'.\n};\n\n/**\n * Details of a Retrieval tool call the run step was involved in.\n * Includes the tool call ID and the type of tool call.\n */\nexport type RetrievalToolCall = {\n  id: string; // The ID of the tool call object.\n  retrieval: unknown; // An empty object for now.\n  type: 'retrieval'; // The type of tool call, always 'retrieval'.\n};\n\n/**\n * Details of the tool calls involved in a run step.\n * Can be associated with one of three types of tools: `code_interpreter`, `retrieval`, or `function`.\n */\nexport type ToolCallsStepDetails = {\n  tool_calls: Array<CodeToolCall | RetrievalToolCall | FunctionToolCall>; // An array of tool calls the run step was involved in.\n  type: 'tool_calls'; // Always 'tool_calls'.\n};\n\nexport type ImageFile = {\n  /**\n   * The [File](https://platform.openai.com/docs/api-reference/files) ID of the image\n   * in the message content.\n   */\n  file_id: string;\n  filename: string;\n  filepath: string;\n  height: number;\n  width: number;\n  /**\n   * Prompt used to generate the image if applicable.\n   */\n  prompt?: string;\n  /**\n   * Additional metadata used to generate or about the image/tool_call.\n   */\n  metadata?: Record<string, unknown>;\n};\n\n// FileCitation.ts\nexport type FileCitation = {\n  end_index: number;\n  file_citation: FileCitationDetails;\n  start_index: number;\n  text: string;\n  type: 'file_citation';\n};\n\nexport type FileCitationDetails = {\n  file_id: string;\n  quote: string;\n};\n\nexport type FilePath = {\n  end_index: number;\n  file_path: FilePathDetails;\n  start_index: number;\n  text: string;\n  type: 'file_path';\n};\n\nexport type FilePathDetails = {\n  file_id: string;\n};\n\nexport type Text = {\n  annotations?: Array<FileCitation | FilePath>;\n  value: string;\n};\n\nexport enum ContentTypes {\n  TEXT = 'text',\n  TOOL_CALL = 'tool_call',\n  IMAGE_FILE = 'image_file',\n}\n\nexport enum StepTypes {\n  TOOL_CALLS = 'tool_calls',\n  MESSAGE_CREATION = 'message_creation',\n}\n\nexport enum ToolCallTypes {\n  FUNCTION = 'function',\n  RETRIEVAL = 'retrieval',\n  CODE_INTERPRETER = 'code_interpreter',\n}\n\nexport enum StepStatus {\n  IN_PROGRESS = 'in_progress',\n  CANCELLED = 'cancelled',\n  FAILED = 'failed',\n  COMPLETED = 'completed',\n  EXPIRED = 'expired',\n}\n\nexport enum MessageContentTypes {\n  TEXT = 'text',\n  IMAGE_FILE = 'image_file',\n}\n\n//enum for RunStatus\n// The status of the run: queued, in_progress, requires_action, cancelling, cancelled, failed, completed, or expired.\nexport enum RunStatus {\n  QUEUED = 'queued',\n  IN_PROGRESS = 'in_progress',\n  REQUIRES_ACTION = 'requires_action',\n  CANCELLING = 'cancelling',\n  CANCELLED = 'cancelled',\n  FAILED = 'failed',\n  COMPLETED = 'completed',\n  EXPIRED = 'expired',\n}\n\nexport type PartMetadata = {\n  progress?: number;\n  asset_pointer?: string;\n  status?: string;\n  action?: boolean;\n};\n\nexport type ContentPart = (CodeToolCall | RetrievalToolCall | FunctionToolCall | ImageFile | Text) &\n  PartMetadata;\n\nexport type TMessageContentParts =\n  | { type: ContentTypes.TEXT; text: Text & PartMetadata }\n  | {\n      type: ContentTypes.TOOL_CALL;\n      tool_call: (CodeToolCall | RetrievalToolCall | FunctionToolCall) & PartMetadata;\n    }\n  | { type: ContentTypes.IMAGE_FILE; image_file: ImageFile & PartMetadata };\n\nexport type TContentData = TMessageContentParts & {\n  messageId: string;\n  conversationId: string;\n  userMessageId: string;\n  thread_id: string;\n  index: number;\n  stream?: boolean;\n};\n\nexport const actionDelimiter = '_action_';\n\nexport enum AuthTypeEnum {\n  ServiceHttp = 'service_http',\n  OAuth = 'oauth',\n  None = 'none',\n}\n\nexport enum AuthorizationTypeEnum {\n  Bearer = 'bearer',\n  Basic = 'basic',\n  Custom = 'custom',\n}\n\nexport enum TokenExchangeMethodEnum {\n  DefaultPost = 'default_post',\n  BasicAuthHeader = 'basic_auth_header',\n}\n\nexport type ActionAuth = {\n  authorization_type?: AuthorizationTypeEnum;\n  custom_auth_header?: string;\n  type?: AuthTypeEnum;\n  authorization_content_type?: string;\n  authorization_url?: string;\n  client_url?: string;\n  scope?: string;\n  token_exchange_method?: TokenExchangeMethodEnum;\n};\n\nexport type ActionMetadata = {\n  api_key?: string;\n  auth?: ActionAuth;\n  domain?: string;\n  privacy_policy_url?: string;\n  raw_spec?: string;\n  oauth_client_id?: string;\n  oauth_client_secret?: string;\n};\n\nexport type Action = {\n  action_id: string;\n  assistant_id: string;\n  type?: string;\n  settings?: Record<string, unknown>;\n  metadata: ActionMetadata;\n};\n\nexport type AssistantAvatar = {\n  filepath: string;\n  source: string;\n};\n\nexport type AssistantDocument = {\n  user: string;\n  assistant_id: string;\n  avatar?: AssistantAvatar;\n  access_level?: number;\n  file_ids?: string[];\n  actions?: string[];\n  createdAt?: Date;\n  updatedAt?: Date;\n};\n\nexport enum FilePurpose {\n  FineTune = 'fine-tune',\n  FineTuneResults = 'fine-tune-results',\n  Assistants = 'assistants',\n  AssistantsOutput = 'assistants_output',\n}\n","export enum QueryKeys {\n  messages = 'messages',\n  allConversations = 'allConversations',\n  searchConversations = 'searchConversations',\n  conversation = 'conversation',\n  searchEnabled = 'searchEnabled',\n  user = 'user',\n  name = 'name', // user key name\n  models = 'models',\n  balance = 'balance',\n  endpoints = 'endpoints',\n  presets = 'presets',\n  searchResults = 'searchResults',\n  tokenCount = 'tokenCount',\n  availablePlugins = 'availablePlugins',\n  startupConfig = 'startupConfig',\n  assistants = 'assistants',\n  assistant = 'assistant',\n  endpointsConfigOverride = 'endpointsConfigOverride',\n  files = 'files',\n  fileConfig = 'fileConfig',\n  tools = 'tools',\n  actions = 'actions',\n  assistantDocs = 'assistantDocs',\n}\n\nexport enum MutationKeys {\n  fileUpload = 'fileUpload',\n  fileDelete = 'fileDelete',\n  updatePreset = 'updatePreset',\n  deletePreset = 'deletePreset',\n  logoutUser = 'logoutUser',\n  avatarUpload = 'avatarUpload',\n  assistantAvatarUpload = 'assistantAvatarUpload',\n  updateAction = 'updateAction',\n  deleteAction = 'deleteAction',\n}\n","import axios from 'axios';\n\nexport function setAcceptLanguageHeader(value: string): void {\n  axios.defaults.headers.common['Accept-Language'] = value;\n}\n\nexport function setTokenHeader(token: string) {\n  axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n}\n","export const user = () => '/api/user';\n\nexport const balance = () => '/api/balance';\n\nexport const userPlugins = () => '/api/user/plugins';\n\nexport const messages = (conversationId: string, messageId?: string) =>\n  `/api/messages/${conversationId}${messageId ? `/${messageId}` : ''}`;\n\nconst keysEndpoint = '/api/keys';\n\nexport const keys = () => keysEndpoint;\n\nexport const userKeyQuery = (name: string) => `${keysEndpoint}?name=${name}`;\n\nexport const revokeUserKey = (name: string) => `${keysEndpoint}/${name}`;\n\nexport const revokeAllUserKeys = () => `${keysEndpoint}?all=true`;\n\nexport const abortRequest = (endpoint: string) => `/api/ask/${endpoint}/abort`;\n\nexport const conversations = (pageNumber: string) => `/api/convos?pageNumber=${pageNumber}`;\n\nexport const conversationById = (id: string) => `/api/convos/${id}`;\n\nexport const genTitle = () => '/api/convos/gen_title';\n\nexport const updateConversation = () => '/api/convos/update';\n\nexport const deleteConversation = () => '/api/convos/clear';\n\nexport const search = (q: string, pageNumber: string) =>\n  `/api/search?q=${q}&pageNumber=${pageNumber}`;\n\nexport const searchEnabled = () => '/api/search/enable';\n\nexport const presets = () => '/api/presets';\n\nexport const deletePreset = () => '/api/presets/delete';\n\nexport const aiEndpoints = () => '/api/endpoints';\n\nexport const endpointsConfigOverride = () => '/api/endpoints/config/override';\n\nexport const models = () => '/api/models';\n\nexport const tokenizer = () => '/api/tokenizer';\n\nexport const login = () => '/api/auth/login';\n\nexport const logout = () => '/api/auth/logout';\n\nexport const register = () => '/api/auth/register';\n\nexport const loginFacebook = () => '/api/auth/facebook';\n\nexport const loginGoogle = () => '/api/auth/google';\n\nexport const refreshToken = (retry?: boolean) => `/api/auth/refresh${retry ? '?retry=true' : ''}`;\n\nexport const requestPasswordReset = () => '/api/auth/requestPasswordReset';\n\nexport const resetPassword = () => '/api/auth/resetPassword';\n\nexport const plugins = () => '/api/plugins';\n\nexport const config = () => '/api/config';\n\nexport const assistants = (id?: string) => `/api/assistants${id ? `/${id}` : ''}`;\n\nexport const files = () => '/api/files';\n\nexport const images = () => `${files()}/images`;\n\nexport const avatar = () => `${images()}/avatar`;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport axios, { AxiosRequestConfig, AxiosError } from 'axios';\nimport { setTokenHeader } from './headers-helpers';\nimport * as endpoints from './api-endpoints';\n\nasync function _get<T>(url: string, options?: AxiosRequestConfig): Promise<T> {\n  const response = await axios.get(url, { ...options });\n  return response.data;\n}\n\nasync function _post(url: string, data?: any) {\n  const response = await axios.post(url, JSON.stringify(data), {\n    headers: { 'Content-Type': 'application/json' },\n  });\n  return response.data;\n}\n\nasync function _postMultiPart(url: string, formData: FormData, options?: AxiosRequestConfig) {\n  const response = await axios.post(url, formData, {\n    ...options,\n    headers: { 'Content-Type': 'multipart/form-data' },\n  });\n  return response.data;\n}\n\nasync function _put(url: string, data?: any) {\n  const response = await axios.put(url, JSON.stringify(data), {\n    headers: { 'Content-Type': 'application/json' },\n  });\n  return response.data;\n}\n\nasync function _delete<T>(url: string): Promise<T> {\n  const response = await axios.delete(url);\n  return response.data;\n}\n\nasync function _deleteWithOptions<T>(url: string, options?: AxiosRequestConfig): Promise<T> {\n  const response = await axios.delete(url, { ...options });\n  return response.data;\n}\n\nasync function _patch(url: string, data?: any) {\n  const response = await axios.patch(url, JSON.stringify(data), {\n    headers: { 'Content-Type': 'application/json' },\n  });\n  return response.data;\n}\n\nlet isRefreshing = false;\nlet failedQueue: { resolve: (value?: any) => void; reject: (reason?: any) => void }[] = [];\n\nconst refreshToken = (retry?: boolean) => _post(endpoints.refreshToken(retry));\n\nconst processQueue = (error: AxiosError | null, token: string | null = null) => {\n  failedQueue.forEach((prom) => {\n    if (error) {\n      prom.reject(error);\n    } else {\n      prom.resolve(token);\n    }\n  });\n  failedQueue = [];\n};\n\naxios.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n\n    if (error.response.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      if (isRefreshing) {\n        try {\n          const token = await new Promise((resolve, reject) => {\n            failedQueue.push({ resolve, reject });\n          });\n          originalRequest.headers['Authorization'] = 'Bearer ' + token;\n          return await axios(originalRequest);\n        } catch (err) {\n          return Promise.reject(err);\n        }\n      }\n\n      isRefreshing = true;\n\n      try {\n        const { token } = await refreshToken(\n          // Handle edge case where we get a blank screen if the initial 401 error is from a refresh token request\n          originalRequest.url?.includes('api/auth/refresh') ? true : false,\n        );\n\n        if (token) {\n          originalRequest.headers['Authorization'] = 'Bearer ' + token;\n          setTokenHeader(token);\n          window.dispatchEvent(new CustomEvent('tokenUpdated', { detail: token }));\n          processQueue(null, token);\n          return await axios(originalRequest);\n        } else {\n          window.location.href = '/login';\n        }\n      } catch (err) {\n        processQueue(err as AxiosError, null);\n        return Promise.reject(err);\n      } finally {\n        isRefreshing = false;\n      }\n    }\n\n    return Promise.reject(error);\n  },\n);\n\nexport default {\n  get: _get,\n  post: _post,\n  postMultiPart: _postMultiPart,\n  put: _put,\n  delete: _delete,\n  deleteWithOptions: _deleteWithOptions,\n  patch: _patch,\n  refreshToken,\n};\n","import * as f from './types/files';\nimport * as q from './types/queries';\nimport * as m from './types/mutations';\nimport * as a from './types/assistants';\nimport * as t from './types';\nimport * as s from './schemas';\nimport request from './request';\nimport * as endpoints from './api-endpoints';\n\nexport function getConversations(pageNumber: string): Promise<t.TGetConversationsResponse> {\n  return request.get(endpoints.conversations(pageNumber));\n}\n\nexport function abortRequestWithMessage(\n  endpoint: string,\n  abortKey: string,\n  message: string,\n): Promise<void> {\n  return request.post(endpoints.abortRequest(endpoint), { arg: { abortKey, message } });\n}\n\nexport function deleteConversation(payload: t.TDeleteConversationRequest) {\n  //todo: this should be a DELETE request\n  return request.post(endpoints.deleteConversation(), { arg: payload });\n}\n\nexport function clearAllConversations(): Promise<unknown> {\n  return request.post(endpoints.deleteConversation(), { arg: {} });\n}\n\nexport function revokeUserKey(name: string): Promise<unknown> {\n  return request.delete(endpoints.revokeUserKey(name));\n}\n\nexport function revokeAllUserKeys(): Promise<unknown> {\n  return request.delete(endpoints.revokeAllUserKeys());\n}\n\nexport function getMessagesByConvoId(conversationId: string): Promise<s.TMessage[]> {\n  if (conversationId === 'new') {\n    return Promise.resolve([]);\n  }\n  return request.get(endpoints.messages(conversationId));\n}\n\nexport function getConversationById(id: string): Promise<s.TConversation> {\n  return request.get(endpoints.conversationById(id));\n}\n\nexport function updateConversation(\n  payload: t.TUpdateConversationRequest,\n): Promise<t.TUpdateConversationResponse> {\n  return request.post(endpoints.updateConversation(), { arg: payload });\n}\n\nexport function genTitle(payload: m.TGenTitleRequest): Promise<m.TGenTitleResponse> {\n  return request.post(endpoints.genTitle(), payload);\n}\n\nexport function updateMessage(payload: t.TUpdateMessageRequest): Promise<unknown> {\n  const { conversationId, messageId, text } = payload;\n  if (!conversationId) {\n    throw new Error('conversationId is required');\n  }\n\n  return request.put(endpoints.messages(conversationId, messageId), { text });\n}\n\nexport function updateUserKey(payload: t.TUpdateUserKeyRequest) {\n  const { value } = payload;\n  if (!value) {\n    throw new Error('value is required');\n  }\n\n  return request.put(endpoints.keys(), payload);\n}\n\nexport function getPresets(): Promise<s.TPreset[]> {\n  return request.get(endpoints.presets());\n}\n\nexport function createPreset(payload: s.TPreset): Promise<s.TPreset> {\n  return request.post(endpoints.presets(), payload);\n}\n\nexport function updatePreset(payload: s.TPreset): Promise<s.TPreset> {\n  return request.post(endpoints.presets(), payload);\n}\n\nexport function deletePreset(arg: s.TPreset | undefined): Promise<m.PresetDeleteResponse> {\n  return request.post(endpoints.deletePreset(), arg);\n}\n\nexport function getSearchEnabled(): Promise<boolean> {\n  return request.get(endpoints.searchEnabled());\n}\n\nexport function getUser(): Promise<t.TUser> {\n  return request.get(endpoints.user());\n}\n\nexport function getUserBalance(): Promise<string> {\n  return request.get(endpoints.balance());\n}\n\nexport const searchConversations = async (\n  q: string,\n  pageNumber: string,\n): Promise<t.TSearchResults> => {\n  return request.get(endpoints.search(q, pageNumber));\n};\n\nexport const updateTokenCount = (text: string) => {\n  return request.post(endpoints.tokenizer(), { arg: text });\n};\n\nexport const login = (payload: t.TLoginUser) => {\n  return request.post(endpoints.login(), payload);\n};\n\nexport const logout = () => {\n  return request.post(endpoints.logout());\n};\n\nexport const register = (payload: t.TRegisterUser) => {\n  return request.post(endpoints.register(), payload);\n};\n\nexport const userKeyQuery = (name: string): Promise<t.TCheckUserKeyResponse> =>\n  request.get(endpoints.userKeyQuery(name));\n\nexport const getLoginGoogle = () => {\n  return request.get(endpoints.loginGoogle());\n};\n\nexport const requestPasswordReset = (\n  payload: t.TRequestPasswordReset,\n): Promise<t.TRequestPasswordResetResponse> => {\n  return request.post(endpoints.requestPasswordReset(), payload);\n};\n\nexport const resetPassword = (payload: t.TResetPassword) => {\n  return request.post(endpoints.resetPassword(), payload);\n};\n\nexport const getAvailablePlugins = (): Promise<s.TPlugin[]> => {\n  return request.get(endpoints.plugins());\n};\n\nexport const updateUserPlugins = (payload: t.TUpdateUserPlugins) => {\n  return request.post(endpoints.userPlugins(), payload);\n};\n\n/* Config */\n\nexport const getStartupConfig = (): Promise<t.TStartupConfig> => {\n  return request.get(endpoints.config());\n};\n\nexport const getAIEndpoints = (): Promise<t.TEndpointsConfig> => {\n  return request.get(endpoints.aiEndpoints());\n};\n\nexport const getModels = async (): Promise<t.TModelsConfig> => {\n  return request.get(endpoints.models());\n};\n\nexport const getEndpointsConfigOverride = (): Promise<unknown | boolean> => {\n  return request.get(endpoints.endpointsConfigOverride());\n};\n\n/* Assistants */\n\nexport const createAssistant = (data: a.AssistantCreateParams): Promise<a.Assistant> => {\n  return request.post(endpoints.assistants(), data);\n};\n\nexport const getAssistantById = (assistant_id: string): Promise<a.Assistant> => {\n  return request.get(endpoints.assistants(assistant_id));\n};\n\nexport const updateAssistant = (\n  assistant_id: string,\n  data: a.AssistantUpdateParams,\n): Promise<a.Assistant> => {\n  return request.patch(endpoints.assistants(assistant_id), data);\n};\n\nexport const deleteAssistant = (assistant_id: string): Promise<void> => {\n  return request.delete(endpoints.assistants(assistant_id));\n};\n\nexport const listAssistants = (\n  params?: a.AssistantListParams,\n): Promise<a.AssistantListResponse> => {\n  return request.get(endpoints.assistants(), { params });\n};\n\n/* Tools */\n\nexport const getAvailableTools = (): Promise<s.TPlugin[]> => {\n  return request.get(`${endpoints.assistants()}/tools`);\n};\n\n/* Files */\n\nexport const getFiles = (): Promise<f.TFile[]> => {\n  return request.get(endpoints.files());\n};\n\nexport const getFileConfig = (): Promise<f.FileConfig> => {\n  return request.get(`${endpoints.files()}/config`);\n};\n\nexport const uploadImage = (data: FormData): Promise<f.TFileUpload> => {\n  return request.postMultiPart(endpoints.images(), data);\n};\n\nexport const uploadFile = (data: FormData): Promise<f.TFileUpload> => {\n  return request.postMultiPart(endpoints.files(), data);\n};\n\nexport const uploadAvatar = (data: FormData): Promise<f.AvatarUploadResponse> => {\n  return request.postMultiPart(endpoints.avatar(), data);\n};\n\nexport const uploadAssistantAvatar = (data: m.AssistantAvatarVariables): Promise<a.Assistant> => {\n  return request.postMultiPart(endpoints.assistants(`avatar/${data.assistant_id}`), data.formData);\n};\n\nexport const updateAction = (data: m.UpdateActionVariables): Promise<m.UpdateActionResponse> => {\n  const { assistant_id, ...body } = data;\n  return request.post(endpoints.assistants(`actions/${assistant_id}`), body);\n};\n\nexport function getActions(): Promise<a.Action[]> {\n  return request.get(endpoints.assistants('actions'));\n}\n\nexport function getAssistantDocs(): Promise<a.AssistantDocument[]> {\n  return request.get(endpoints.assistants('documents'));\n}\n\nexport const deleteFiles = async (\n  files: f.BatchFile[],\n  assistant_id?: string,\n): Promise<f.DeleteFilesResponse> =>\n  request.deleteWithOptions(endpoints.files(), {\n    data: { files, assistant_id },\n  });\n\n/* conversations */\n\nexport const listConversations = (\n  params?: q.ConversationListParams,\n): Promise<q.ConversationListResponse> => {\n  // Assuming params has a pageNumber property\n  const pageNumber = params?.pageNumber || '1'; // Default to page 1 if not provided\n  return request.get(endpoints.conversations(pageNumber));\n};\n\nexport const listConversationsByQuery = (\n  params?: q.ConversationListParams & { searchQuery?: string },\n): Promise<q.ConversationListResponse> => {\n  const pageNumber = params?.pageNumber || '1'; // Default to page 1 if not provided\n  const searchQuery = params?.searchQuery || ''; // If no search query is provided, default to an empty string\n  // Update the endpoint to handle a search query\n  if (searchQuery !== '') {\n    return request.get(endpoints.search(searchQuery, pageNumber));\n  } else {\n    return request.get(endpoints.conversations(pageNumber));\n  }\n};\n\nexport const deleteAction = async (assistant_id: string, action_id: string): Promise<void> =>\n  request.delete(endpoints.assistants(`actions/${assistant_id}/${action_id}`));\n","/* eslint-disable */\n/**\n * Copyright (C) 2016 Maxime Petazzoni <maxime.petazzoni@bulix.org>.\n * All rights reserved.\n */\n\nimport request from './request';\nimport { setTokenHeader } from './headers-helpers';\n\nvar SSE = function (url, options) {\n  if (!(this instanceof SSE)) {\n    return new SSE(url, options);\n  }\n\n  this.INITIALIZING = -1;\n  this.CONNECTING = 0;\n  this.OPEN = 1;\n  this.CLOSED = 2;\n\n  this.url = url;\n\n  options = options || {};\n  this.headers = options.headers || {};\n  this.payload = options.payload !== undefined ? options.payload : '';\n  this.method = options.method || (this.payload && 'POST') || 'GET';\n  this.withCredentials = !!options.withCredentials;\n\n  this.FIELD_SEPARATOR = ':';\n  this.listeners = {};\n\n  this.xhr = null;\n  this.readyState = this.INITIALIZING;\n  this.progress = 0;\n  this.chunk = '';\n\n  this.addEventListener = function (type, listener) {\n    if (this.listeners[type] === undefined) {\n      this.listeners[type] = [];\n    }\n\n    if (this.listeners[type].indexOf(listener) === -1) {\n      this.listeners[type].push(listener);\n    }\n  };\n\n  this.removeEventListener = function (type, listener) {\n    if (this.listeners[type] === undefined) {\n      return;\n    }\n\n    var filtered = [];\n    this.listeners[type].forEach(function (element) {\n      if (element !== listener) {\n        filtered.push(element);\n      }\n    });\n    if (filtered.length === 0) {\n      delete this.listeners[type];\n    } else {\n      this.listeners[type] = filtered;\n    }\n  };\n\n  this.dispatchEvent = function (e) {\n    if (!e) {\n      return true;\n    }\n\n    e.source = this;\n\n    var onHandler = 'on' + e.type;\n    if (this.hasOwnProperty(onHandler)) {\n      this[onHandler].call(this, e);\n      if (e.defaultPrevented) {\n        return false;\n      }\n    }\n\n    if (this.listeners[e.type]) {\n      return this.listeners[e.type].every(function (callback) {\n        callback(e);\n        return !e.defaultPrevented;\n      });\n    }\n\n    return true;\n  };\n\n  this._setReadyState = function (state) {\n    var event = new CustomEvent('readystatechange');\n    event.readyState = state;\n    this.readyState = state;\n    this.dispatchEvent(event);\n  };\n\n  this._onStreamFailure = function (e) {\n    var event = new CustomEvent('error');\n    event.data = e.currentTarget.response;\n    this.dispatchEvent(event);\n    this.close();\n  };\n\n  this._onStreamAbort = function (e) {\n    this.dispatchEvent(new CustomEvent('abort'));\n    this.close();\n  };\n\n  this._onStreamProgress = async function (e) {\n    if (!this.xhr) {\n      return;\n    }\n\n    if (this.xhr.status === 401 && !this._retry) {\n      this._retry = true;\n      try {\n        const refreshResponse = await request.refreshToken();\n        this.headers = {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${refreshResponse.token}`,\n        };\n        setTokenHeader(refreshResponse.token);\n        window.dispatchEvent(new CustomEvent('tokenUpdated', { detail: refreshResponse.token }));\n        this.stream();\n      } catch (err) {\n        this._onStreamFailure(e);\n        return;\n      }\n    } else if (this.xhr.status !== 200) {\n      this._onStreamFailure(e);\n      return;\n    }\n\n    if (this.readyState == this.CONNECTING) {\n      this.dispatchEvent(new CustomEvent('open'));\n      this._setReadyState(this.OPEN);\n    }\n\n    var data = this.xhr.responseText.substring(this.progress);\n    this.progress += data.length;\n    data.split(/(\\r\\n|\\r|\\n){2}/g).forEach(\n      function (part) {\n        if (part.trim().length === 0) {\n          this.dispatchEvent(this._parseEventChunk(this.chunk.trim()));\n          this.chunk = '';\n        } else {\n          this.chunk += part;\n        }\n      }.bind(this),\n    );\n  };\n\n  this._onStreamLoaded = function (e) {\n    this._onStreamProgress(e);\n\n    // Parse the last chunk.\n    this.dispatchEvent(this._parseEventChunk(this.chunk));\n    this.chunk = '';\n  };\n\n  /**\n   * Parse a received SSE event chunk into a constructed event object.\n   */\n  this._parseEventChunk = function (chunk) {\n    if (!chunk || chunk.length === 0) {\n      return null;\n    }\n\n    var e = { id: null, retry: null, data: '', event: 'message' };\n    chunk.split(/\\n|\\r\\n|\\r/).forEach(\n      function (line) {\n        line = line.trimRight();\n        var index = line.indexOf(this.FIELD_SEPARATOR);\n        if (index <= 0) {\n          // Line was either empty, or started with a separator and is a comment.\n          // Either way, ignore.\n          return;\n        }\n\n        var field = line.substring(0, index);\n        if (!(field in e)) {\n          return;\n        }\n\n        var value = line.substring(index + 1).trimLeft();\n        if (field === 'data') {\n          e[field] += value;\n        } else {\n          e[field] = value;\n        }\n      }.bind(this),\n    );\n\n    var event = new CustomEvent(e.event);\n    event.data = e.data;\n    event.id = e.id;\n    return event;\n  };\n\n  this._checkStreamClosed = function () {\n    if (!this.xhr) {\n      return;\n    }\n\n    if (this.xhr.readyState === XMLHttpRequest.DONE) {\n      this._setReadyState(this.CLOSED);\n    }\n  };\n\n  this.stream = function () {\n    this._setReadyState(this.CONNECTING);\n\n    this.xhr = new XMLHttpRequest();\n    this.xhr.addEventListener('progress', this._onStreamProgress.bind(this));\n    this.xhr.addEventListener('load', this._onStreamLoaded.bind(this));\n    this.xhr.addEventListener('readystatechange', this._checkStreamClosed.bind(this));\n    this.xhr.addEventListener('error', this._onStreamFailure.bind(this));\n    this.xhr.addEventListener('abort', this._onStreamAbort.bind(this));\n    this.xhr.open(this.method, this.url);\n    for (var header in this.headers) {\n      this.xhr.setRequestHeader(header, this.headers[header]);\n    }\n    this.xhr.withCredentials = this.withCredentials;\n    this.xhr.send(this.payload);\n  };\n\n  this.close = function () {\n    if (this.readyState === this.CLOSED) {\n      return;\n    }\n\n    this.xhr.abort();\n    this.xhr = null;\n    this._setReadyState(this.CLOSED);\n  };\n};\n\nexport { SSE };\n// Export our SSE module for npm.js\n// if (typeof exports !== 'undefined') {\n//   // exports.SSE = SSE;\n//   module.exports = { SSE };\n// }\n","import axios from 'axios';\nimport { URL } from 'url';\nimport crypto from 'crypto';\nimport { load } from 'js-yaml';\nimport type { FunctionTool, Schema, Reference, ActionMetadata } from './types/assistants';\nimport type { OpenAPIV3 } from 'openapi-types';\nimport { Tools, AuthTypeEnum, AuthorizationTypeEnum } from './types/assistants';\n\nexport type ParametersSchema = {\n  type: string;\n  properties: Record<string, Reference | Schema>;\n  required: string[];\n};\n\nexport type ApiKeyCredentials = {\n  api_key: string;\n  custom_auth_header?: string;\n  authorization_type?: AuthorizationTypeEnum;\n};\n\nexport type OAuthCredentials = {\n  tokenUrl: string;\n  clientId: string;\n  clientSecret: string;\n  scope: string;\n};\n\nexport type Credentials = ApiKeyCredentials | OAuthCredentials;\n\nexport function sha1(input: string) {\n  return crypto.createHash('sha1').update(input).digest('hex');\n}\n\nexport function createURL(domain: string, path: string) {\n  const myURL = new URL(path, domain);\n  return myURL.toString();\n}\n\nexport class FunctionSignature {\n  name: string;\n  description: string;\n  parameters: ParametersSchema;\n\n  constructor(name: string, description: string, parameters: ParametersSchema) {\n    this.name = name;\n    this.description = description;\n    if (parameters.properties?.['requestBody']) {\n      this.parameters = parameters.properties?.['requestBody'] as ParametersSchema;\n    } else {\n      this.parameters = parameters;\n    }\n  }\n\n  toObjectTool(): FunctionTool {\n    return {\n      type: Tools.function,\n      function: {\n        name: this.name,\n        description: this.description,\n        parameters: this.parameters,\n      },\n    };\n  }\n}\n\nexport class ActionRequest {\n  domain: string;\n  path: string;\n  method: string;\n  operation: string;\n  operationHash?: string;\n  isConsequential: boolean;\n  contentType: string;\n  params?: object;\n\n  constructor(\n    domain: string,\n    path: string,\n    method: string,\n    operation: string,\n    isConsequential: boolean,\n    contentType: string,\n  ) {\n    this.domain = domain;\n    this.path = path;\n    this.method = method;\n    this.operation = operation;\n    this.isConsequential = isConsequential;\n    this.contentType = contentType;\n  }\n\n  private authHeaders: Record<string, string> = {};\n  private authToken?: string;\n\n  async setParams(params: object) {\n    this.operationHash = sha1(JSON.stringify(params));\n    this.params = params;\n  }\n\n  async setAuth(metadata: ActionMetadata) {\n    if (!metadata.auth) {\n      return;\n    }\n\n    const {\n      type,\n      /* API Key */\n      authorization_type,\n      custom_auth_header,\n      /* OAuth */\n      authorization_url,\n      client_url,\n      scope,\n      token_exchange_method,\n    } = metadata.auth;\n\n    const {\n      /* API Key */\n      api_key,\n      /* OAuth */\n      oauth_client_id,\n      oauth_client_secret,\n    } = metadata;\n\n    const isApiKey = api_key && type === AuthTypeEnum.ServiceHttp;\n    const isOAuth =\n      oauth_client_id &&\n      oauth_client_secret &&\n      type === AuthTypeEnum.OAuth &&\n      authorization_url &&\n      client_url &&\n      scope &&\n      token_exchange_method;\n\n    if (isApiKey && authorization_type === AuthorizationTypeEnum.Basic) {\n      const basicToken = Buffer.from(api_key).toString('base64');\n      this.authHeaders['Authorization'] = `Basic ${basicToken}`;\n    } else if (isApiKey && authorization_type === AuthorizationTypeEnum.Bearer) {\n      this.authHeaders['Authorization'] = `Bearer ${api_key}`;\n    } else if (\n      isApiKey &&\n      authorization_type === AuthorizationTypeEnum.Custom &&\n      custom_auth_header\n    ) {\n      this.authHeaders[custom_auth_header] = api_key;\n    } else if (isOAuth) {\n      // TODO: WIP - OAuth support\n      if (!this.authToken) {\n        const tokenResponse = await axios.post(\n          client_url,\n          {\n            client_id: oauth_client_id,\n            client_secret: oauth_client_secret,\n            scope: scope,\n            grant_type: 'client_credentials',\n          },\n          {\n            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n          },\n        );\n        this.authToken = tokenResponse.data.access_token;\n      }\n      this.authHeaders['Authorization'] = `Bearer ${this.authToken}`;\n    }\n  }\n\n  async execute() {\n    const url = createURL(this.domain, this.path);\n    const headers = {\n      ...this.authHeaders,\n      'Content-Type': this.contentType,\n    };\n\n    const method = this.method.toLowerCase();\n\n    if (method === 'get') {\n      return axios.get(url, { headers, params: this.params });\n    } else if (method === 'post') {\n      return axios.post(url, this.params, { headers });\n    } else if (method === 'put') {\n      return axios.put(url, this.params, { headers });\n    } else if (method === 'delete') {\n      return axios.delete(url, { headers, data: this.params });\n    } else if (method === 'patch') {\n      return axios.patch(url, this.params, { headers });\n    } else {\n      throw new Error(`Unsupported HTTP method: ${this.method}`);\n    }\n  }\n}\n\nexport function resolveRef(\n  schema: OpenAPIV3.SchemaObject | OpenAPIV3.ReferenceObject | OpenAPIV3.RequestBodyObject,\n  components?: OpenAPIV3.ComponentsObject,\n): OpenAPIV3.SchemaObject {\n  if ('$ref' in schema && components) {\n    const refPath = schema.$ref.replace(/^#\\/components\\/schemas\\//, '');\n    const resolvedSchema = components.schemas?.[refPath];\n    if (!resolvedSchema) {\n      throw new Error(`Reference ${schema.$ref} not found`);\n    }\n    return resolveRef(resolvedSchema, components);\n  }\n  return schema as OpenAPIV3.SchemaObject;\n}\n\n/** Function to convert OpenAPI spec to function signatures and request builders */\nexport function openapiToFunction(openapiSpec: OpenAPIV3.Document): {\n  functionSignatures: FunctionSignature[];\n  requestBuilders: Record<string, ActionRequest>;\n} {\n  const functionSignatures: FunctionSignature[] = [];\n  const requestBuilders: Record<string, ActionRequest> = {};\n\n  // Base URL from OpenAPI spec servers\n  const baseUrl = openapiSpec.servers?.[0]?.url ?? '';\n\n  // Iterate over each path and method in the OpenAPI spec\n  for (const [path, methods] of Object.entries(openapiSpec.paths)) {\n    for (const [method, operation] of Object.entries(methods as OpenAPIV3.PathsObject)) {\n      const operationObj = operation as OpenAPIV3.OperationObject & {\n        'x-openai-isConsequential'?: boolean;\n      };\n\n      // Operation ID is used as the function name\n      const operationId = operationObj.operationId || `${method}_${path}`;\n      const description = operationObj.summary || operationObj.description || '';\n\n      const parametersSchema: ParametersSchema = { type: 'object', properties: {}, required: [] };\n\n      if (operationObj.requestBody) {\n        const requestBody = operationObj.requestBody as OpenAPIV3.RequestBodyObject;\n        const content = requestBody.content;\n        const contentType = Object.keys(content)[0];\n        const schema = content[contentType]?.schema;\n        const resolvedSchema = resolveRef(\n          schema as OpenAPIV3.ReferenceObject | OpenAPIV3.SchemaObject,\n          openapiSpec.components,\n        );\n        parametersSchema.properties['requestBody'] = resolvedSchema;\n      }\n\n      if (operationObj.parameters) {\n        for (const param of operationObj.parameters) {\n          const paramObj = param as OpenAPIV3.ParameterObject;\n          const resolvedSchema = resolveRef(\n            { ...paramObj.schema } as OpenAPIV3.ReferenceObject | OpenAPIV3.SchemaObject,\n            openapiSpec.components,\n          );\n          parametersSchema.properties[paramObj.name] = resolvedSchema;\n          if (paramObj.required) {\n            parametersSchema.required.push(paramObj.name);\n          }\n          if (paramObj.description && !('$$ref' in parametersSchema.properties[paramObj.name])) {\n            parametersSchema.properties[paramObj.name].description = paramObj.description;\n          }\n        }\n      }\n\n      const functionSignature = new FunctionSignature(operationId, description, parametersSchema);\n      functionSignatures.push(functionSignature);\n\n      const actionRequest = new ActionRequest(\n        baseUrl,\n        path,\n        method,\n        operationId,\n        !!operationObj['x-openai-isConsequential'], // Custom extension for consequential actions\n        operationObj.requestBody ? 'application/json' : 'application/x-www-form-urlencoded',\n      );\n\n      requestBuilders[operationId] = actionRequest;\n    }\n  }\n\n  return { functionSignatures, requestBuilders };\n}\n\nexport type ValidationResult = {\n  status: boolean;\n  message: string;\n  spec?: OpenAPIV3.Document;\n};\n\nexport function validateAndParseOpenAPISpec(specString: string): ValidationResult {\n  try {\n    let parsedSpec;\n    try {\n      parsedSpec = JSON.parse(specString);\n    } catch {\n      parsedSpec = load(specString);\n    }\n\n    // Check for servers\n    if (\n      !parsedSpec.servers ||\n      !Array.isArray(parsedSpec.servers) ||\n      parsedSpec.servers.length === 0\n    ) {\n      return { status: false, message: 'Could not find a valid URL in `servers`' };\n    }\n\n    if (!parsedSpec.servers[0].url) {\n      return { status: false, message: 'Could not find a valid URL in `servers`' };\n    }\n\n    // Check for paths\n    const paths = parsedSpec.paths;\n    if (!paths || typeof paths !== 'object' || Object.keys(paths).length === 0) {\n      return { status: false, message: 'No paths found in the OpenAPI spec.' };\n    }\n\n    const components = parsedSpec.components?.schemas || {};\n    const messages = [];\n\n    for (const [path, methods] of Object.entries(paths)) {\n      for (const [httpMethod, operation] of Object.entries(methods as OpenAPIV3.PathItemObject)) {\n        // Ensure operation is a valid operation object\n        const { responses } = operation as OpenAPIV3.OperationObject;\n        if (typeof operation === 'object' && responses) {\n          for (const [statusCode, response] of Object.entries(responses)) {\n            const content = (response as OpenAPIV3.ResponseObject).content;\n            if (content && content['application/json'] && content['application/json'].schema) {\n              const schema = content['application/json'].schema;\n              if ('$ref' in schema && typeof schema.$ref === 'string') {\n                const refName = schema.$ref.split('/').pop();\n                if (refName && !components[refName]) {\n                  messages.push(\n                    `In context=('paths', '${path}', '${httpMethod}', '${statusCode}', 'response', 'content', 'application/json', 'schema'), reference to unknown component ${refName}; using empty schema`,\n                  );\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return {\n      status: true,\n      message: messages.join('\\n') || 'OpenAPI spec is valid.',\n      spec: parsedSpec,\n    };\n  } catch (error) {\n    return { status: false, message: 'Error parsing OpenAPI spec.' };\n  }\n}\n","import type { TSubmission, TMessage, TEndpointOption } from './types';\nimport { tConvoUpdateSchema, EModelEndpoint } from './schemas';\nimport { EndpointURLs } from './config';\n\nexport default function createPayload(submission: TSubmission) {\n  const { conversation, message, messages, endpointOption, isEdited, isContinued } = submission;\n  const { conversationId } = tConvoUpdateSchema.parse(conversation);\n  const { endpoint, endpointType } = endpointOption as {\n    endpoint: EModelEndpoint;\n    endpointType?: EModelEndpoint;\n  };\n\n  let server = EndpointURLs[endpointType ?? endpoint];\n\n  if (isEdited && endpoint === EModelEndpoint.assistants) {\n    server += '/modify';\n  } else if (isEdited) {\n    server = server.replace('/ask/', '/edit/');\n  }\n\n  type Payload = Partial<TMessage> &\n    Partial<TEndpointOption> & {\n      isContinued: boolean;\n      conversationId: string | null;\n      messages?: typeof messages;\n    };\n\n  const payload: Payload = {\n    ...message,\n    ...endpointOption,\n    isContinued: !!(isEdited && isContinued),\n    conversationId,\n  };\n\n  return { server, payload };\n}\n"],"names":["EModelEndpoint","isUUID","z","string","uuid","ImageDetail","endpointSettings","_a","google","model","default","maxOutputTokens","min","max","step","maxGeminiPro","defaultGeminiPro","temperature","topP","topK","eModelEndpointSchema","nativeEnum","extendedModelEndpointSchema","union","imageDetailNumeric","_b","low","auto","high","imageDetailValue","eImageDetailSchema","tPluginAuthConfigSchema","object","authField","label","description","tPluginSchema","name","pluginKey","icon","authConfig","array","authenticated","boolean","optional","isButton","tExampleSchema","input","content","output","tAgentOptionsSchema","agent","skipCompletion","number","tMessageSchema","messageId","endpoint","clientId","nullable","conversationId","parentMessageId","responseMessageId","overrideParentMessageId","bg","title","or","literal","sender","text","generation","isEdited","isCreatedByUser","error","createdAt","Date","toISOString","updatedAt","current","unfinished","searchResult","finish_reason","thread_id","tConversationSchema","user","endpointType","suggestions","messages","tools","systemMessage","modelLabel","examples","chatGptLabel","userLabel","promptPrefix","context","top_p","frequency_penalty","presence_penalty","jailbreak","jailbreakConversationId","conversationSignature","invocationId","toneStyle","agentOptions","file_ids","resendImages","imageDetail","assistant_id","instructions","presetOverride","record","unknown","tPresetSchema","omit","merge","presetId","defaultPreset","order","tConvoUpdateSchema","tPresetUpdateSchema","openAISchema","pick","transform","obj","_c","_d","_e","_f","_g","_h","_j","catch","googleSchema","isGeminiPro","toLowerCase","includes","maxOutputTokensMax","maxOutputTokensDefault","Math","__assign","_k","bingAISchema","anthropicSchema","chatGPTBrowserSchema","gptPluginsSchema","removeNullishValues","newObj","Object","keys","forEach","key","undefined","FileSources","FileContext","assistantSchema","compactOpenAISchema","compactGoogleSchema","compactAnthropicSchema","compactChatGPTSchema","compactPluginsSchema","length","supportsFiles","openAI","assistants","azureOpenAI","custom","excelFileTypes","fullMimeTypesList","__spreadArray","codeInterpreterMimeTypesList","excelMimeTypes","textMimeTypes","applicationMimeTypes","imageMimeTypes","supportedMimeTypes","codeInterpreterMimeTypes","megabyte","mbToBytes","mb","fileConfig","endpoints","fileLimit","fileSizeLimit","totalSizeLimit","disabled","serverFileSizeLimit","avatarSizeLimit","checkType","fileType","supportedTypes","some","regex","test","supportedMimeTypesSchema","any","refine","mimeTypes","every","mimeType","RegExp","message","endpointFileConfigSchema","fileConfigSchema","convertStringsToRegex","patterns","reduce","acc","pattern","push","console","KnownEndpoints","fileSourceSchema","assistantEndpointSchema","disableBuilder","pollIntervalMs","timeoutMs","supportedIds","excludedIds","apiKey","baseURL","models","fetch","userIdQuery","titleConvo","titleMethod","titleModel","headers","endpointSchema","value","safeParse","success","concat","values","join","summarize","summaryModel","forcePrompt","modelDisplayLabel","addParams","dropParams","rateLimitSchema","fileUploads","ipMax","ipWindowInMinutes","userMax","userWindowInMinutes","configSchema","version","cache","fileStrategy","registration","socialLogins","allowedDomains","rateLimits","partial","strict","data","defaultEndpoints","bingAI","chatGPTBrowser","gptPlugins","anthropic","alternateName","defaultModels","supportsRetrieval","Set","EndpointURLs","modularEndpoints","supportsBalanceCheck","visionModels","CacheKeys","AuthKeys","ImageDetailCost","SettingsTabValues","Constants","imageGenTools","endpointSchemas","getFirstDefinedValue","possibleValues","returnValue","_i","possibleValues_1","Tools","ContentTypes","StepTypes","ToolCallTypes","StepStatus","MessageContentTypes","RunStatus","compactEndpointSchemas","AuthTypeEnum","AuthorizationTypeEnum","TokenExchangeMethodEnum","FilePurpose","QueryKeys","MutationKeys","setTokenHeader","token","axios","defaults","common","keysEndpoint","conversations","pageNumber","search","q","id","images","_post","url","post","JSON","stringify","sent","isRefreshing","failedQueue","refreshToken","retry","endpoints.refreshToken","processQueue","prom","reject","resolve","interceptors","response","use","__awaiter","originalRequest","config","status","_retry","Promise","err_1","window","dispatchEvent","CustomEvent","detail","location","href","err_2","request","get","options","postMultiPart","formData","put","delete","deleteWithOptions","patch","abortKey","endpoints.abortRequest","arg","endpoints.assistants","payload","action_id","__generator","this","files","endpoints.conversationById","endpoints.conversations","endpoints.messages","params","searchQuery","endpoints.search","endpoints.revokeUserKey","body","__rest","Error","endpoints.images","endpoints.userKeyQuery","SSE","INITIALIZING","CONNECTING","OPEN","CLOSED","method","withCredentials","FIELD_SEPARATOR","listeners","xhr","readyState","progress","chunk","addEventListener","type","listener","indexOf","removeEventListener","filtered","element","e","source","onHandler","hasOwnProperty","call","defaultPrevented","callback","_setReadyState","state","event","_onStreamFailure","currentTarget","close","_onStreamAbort","_onStreamProgress","async","refreshResponse","Authorization","stream","err","responseText","substring","split","part","trim","_parseEventChunk","bind","_onStreamLoaded","line","index","trimRight","field","trimLeft","_checkStreamClosed","XMLHttpRequest","DONE","header","open","setRequestHeader","send","abort","sha1","crypto","createHash","update","digest","createURL","domain","path","URL","toString","FunctionSignature","parameters","properties","prototype","toObjectTool","function","ActionRequest","operation","isConsequential","contentType","authHeaders","setParams","operationHash","setAuth","metadata","auth","authorization_type","custom_auth_header","authorization_url","client_url","scope","token_exchange_method","api_key","oauth_client_id","oauth_client_secret","isApiKey","ServiceHttp","isOAuth","OAuth","Basic","basicToken","Buffer","from","Bearer","Custom","authToken","client_id","client_secret","grant_type","tokenResponse","access_token","execute","resolveRef","schema","components","refPath","$ref","replace","resolvedSchema","schemas","submission","conversation","endpointOption","isContinued","parse","server","assistant","functions","code_interpreter","retrieval","dynamic","mergedConfig","dynamicEndpoint","mergedEndpoint","openapiSpec","functionSignatures","requestBuilders","baseUrl","servers","entries","paths","methods","operationObj","operationId","summary","parametersSchema","required","requestBody","_l","paramObj","functionSignature","actionRequest","convo","secondaryModels","specString","parsedSpec","load","Array","isArray","httpMethod","responses","statusCode","refName","pop","spec","additionalModels","visionModel"],"mappings":"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"}