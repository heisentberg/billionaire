import{useQueryClient as e,useMutation as t,useQuery as n}from"@tanstack/react-query";import{z as o}from"zod";import a from"axios";var r,i,l,s=function(){return s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)};function u(e,t,n,o){return new(n||(n=Promise))((function(a,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function l(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}s((o=o.apply(e,t||[])).next())}))}function p(e,t){var n,o,a,r,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(n=1,o&&(a=2&l[0]?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,o=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=i.trys,(a=a.length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],o=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}}function c(e,t,n){if(n||2===arguments.length)for(var o,a=0,r=t.length;a<r;a++)!o&&a in t||(o||(o=Array.prototype.slice.call(t,0,a)),o[a]=t[a]);return e.concat(o||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError,o.string().uuid(),function(e){e.azureOpenAI="azureOpenAI",e.openAI="openAI",e.bingAI="bingAI",e.chatGPTBrowser="chatGPTBrowser",e.google="google",e.gptPlugins="gptPlugins",e.anthropic="anthropic",e.assistants="assistants",e.custom="custom"}(l||(l={}));var d,f=((r={})[l.google]={model:{default:"chat-bison"},maxOutputTokens:{min:1,max:2048,step:1,default:1024,maxGeminiPro:8192,defaultGeminiPro:8192},temperature:{min:0,max:1,step:.01,default:.2},topP:{min:0,max:1,step:.01,default:.8},topK:{min:1,max:40,step:.01,default:40}},r)[l.google],m=o.nativeEnum(l),g=o.union([m,o.string()]);!function(e){e.low="low",e.auto="auto",e.high="high"}(d||(d={})),(i={})[d.low]=0,i[d.auto]=1,i[d.high]=2,d.low,d.auto,d.high;var v=o.nativeEnum(d),b=o.object({authField:o.string(),label:o.string(),description:o.string()}),h=o.object({name:o.string(),pluginKey:o.string(),description:o.string(),icon:o.string(),authConfig:o.array(b),authenticated:o.boolean().optional(),isButton:o.boolean().optional()}),x=o.object({input:o.object({content:o.string()}),output:o.object({content:o.string()})}),y=o.object({agent:o.string(),skipCompletion:o.boolean(),model:o.string(),temperature:o.number()});o.object({messageId:o.string(),endpoint:o.string().optional(),clientId:o.string().nullable().optional(),conversationId:o.string().nullable(),parentMessageId:o.string().nullable(),responseMessageId:o.string().nullable().optional(),overrideParentMessageId:o.string().nullable().optional(),bg:o.string().nullable().optional(),model:o.string().nullable().optional(),title:o.string().nullable().or(o.literal("New Chat")).default("New Chat"),sender:o.string(),text:o.string(),generation:o.string().nullable().optional(),isEdited:o.boolean().optional(),isCreatedByUser:o.boolean(),error:o.boolean(),createdAt:o.string().optional().default((function(){return(new Date).toISOString()})),updatedAt:o.string().optional().default((function(){return(new Date).toISOString()})),current:o.boolean().optional(),unfinished:o.boolean().optional(),searchResult:o.boolean().optional(),finish_reason:o.string().optional(),thread_id:o.string().optional()});var O,I,P=o.object({conversationId:o.string().nullable(),title:o.string().nullable().or(o.literal("New Chat")).default("New Chat"),user:o.string().optional(),endpoint:m.nullable(),endpointType:m.optional(),suggestions:o.array(o.string()).optional(),messages:o.array(o.string()).optional(),tools:o.array(h).optional(),createdAt:o.string(),updatedAt:o.string(),systemMessage:o.string().nullable().optional(),modelLabel:o.string().nullable().optional(),examples:o.array(x).optional(),chatGptLabel:o.string().nullable().optional(),userLabel:o.string().optional(),model:o.string().nullable().optional(),promptPrefix:o.string().nullable().optional(),temperature:o.number().optional(),topP:o.number().optional(),topK:o.number().optional(),context:o.string().nullable().optional(),top_p:o.number().optional(),frequency_penalty:o.number().optional(),presence_penalty:o.number().optional(),jailbreak:o.boolean().optional(),jailbreakConversationId:o.string().nullable().optional(),conversationSignature:o.string().nullable().optional(),parentMessageId:o.string().optional(),clientId:o.string().nullable().optional(),invocationId:o.number().nullable().optional(),toneStyle:o.string().nullable().optional(),maxOutputTokens:o.number().optional(),agentOptions:y.nullable().optional(),file_ids:o.array(o.string()).optional(),resendImages:o.boolean().optional(),imageDetail:v.optional(),assistant_id:o.string().optional(),instructions:o.string().optional(),presetOverride:o.record(o.unknown()).optional()});function k(e){var t=s({},e);return Object.keys(t).forEach((function(e){void 0!==t[e]&&null!==t[e]&&""!==t[e]||delete t[e]})),t}P.omit({conversationId:!0,createdAt:!0,updatedAt:!0,title:!0}).merge(o.object({conversationId:o.string().nullable().optional(),presetId:o.string().nullable().optional(),title:o.string().nullable().optional(),defaultPreset:o.boolean().optional(),order:o.number().optional(),endpoint:g.nullable()})),P.merge(o.object({endpoint:g.nullable()})),P.merge(o.object({endpoint:g.nullable()})),P.pick({model:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,resendImages:!0,imageDetail:!0}).transform((function(e){var t,n,o,a,r,i,l,u,p;return s(s({},e),{model:null!==(t=e.model)&&void 0!==t?t:"gpt-3.5-turbo",chatGptLabel:null!==(n=e.chatGptLabel)&&void 0!==n?n:null,promptPrefix:null!==(o=e.promptPrefix)&&void 0!==o?o:null,temperature:null!==(a=e.temperature)&&void 0!==a?a:1,top_p:null!==(r=e.top_p)&&void 0!==r?r:1,presence_penalty:null!==(i=e.presence_penalty)&&void 0!==i?i:0,frequency_penalty:null!==(l=e.frequency_penalty)&&void 0!==l?l:0,resendImages:null!==(u=e.resendImages)&&void 0!==u&&u,imageDetail:null!==(p=e.imageDetail)&&void 0!==p?p:d.auto})})).catch((function(){return{model:"gpt-3.5-turbo",chatGptLabel:null,promptPrefix:null,temperature:1,top_p:1,presence_penalty:0,frequency_penalty:0,resendImages:!1,imageDetail:d.auto}})),P.pick({model:!0,modelLabel:!0,promptPrefix:!0,examples:!0,temperature:!0,maxOutputTokens:!0,topP:!0,topK:!0}).transform((function(e){var t,n,o,a,r,i,l,u,p,c,d=null===(n=null===(t=null==e?void 0:e.model)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes("gemini-pro"),m=d?f.maxOutputTokens.maxGeminiPro:f.maxOutputTokens.max,g=d?f.maxOutputTokens.defaultGeminiPro:f.maxOutputTokens.default,v=null!==(o=e.maxOutputTokens)&&void 0!==o?o:g;return v=Math.min(v,m),s(s({},e),{model:null!==(a=e.model)&&void 0!==a?a:f.model.default,modelLabel:null!==(r=e.modelLabel)&&void 0!==r?r:null,promptPrefix:null!==(i=e.promptPrefix)&&void 0!==i?i:null,examples:null!==(l=e.examples)&&void 0!==l?l:[{input:{content:""},output:{content:""}}],temperature:null!==(u=e.temperature)&&void 0!==u?u:f.temperature.default,maxOutputTokens:v,topP:null!==(p=e.topP)&&void 0!==p?p:f.topP.default,topK:null!==(c=e.topK)&&void 0!==c?c:f.topK.default})})).catch((function(){return{model:f.model.default,modelLabel:null,promptPrefix:null,examples:[{input:{content:""},output:{content:""}}],temperature:f.temperature.default,maxOutputTokens:f.maxOutputTokens.default,topP:f.topP.default,topK:f.topK.default}})),P.pick({jailbreak:!0,systemMessage:!0,context:!0,toneStyle:!0,jailbreakConversationId:!0,conversationSignature:!0,clientId:!0,invocationId:!0}).transform((function(e){var t,n,o,a,r,i,l,u;return s(s({},e),{model:"",jailbreak:null!==(t=e.jailbreak)&&void 0!==t&&t,systemMessage:null!==(n=e.systemMessage)&&void 0!==n?n:null,context:null!==(o=e.context)&&void 0!==o?o:null,toneStyle:null!==(a=e.toneStyle)&&void 0!==a?a:"creative",jailbreakConversationId:null!==(r=e.jailbreakConversationId)&&void 0!==r?r:null,conversationSignature:null!==(i=e.conversationSignature)&&void 0!==i?i:null,clientId:null!==(l=e.clientId)&&void 0!==l?l:null,invocationId:null!==(u=e.invocationId)&&void 0!==u?u:1})})).catch((function(){return{model:"",jailbreak:!1,systemMessage:null,context:null,toneStyle:"creative",jailbreakConversationId:null,conversationSignature:null,clientId:null,invocationId:1}})),P.pick({model:!0,modelLabel:!0,promptPrefix:!0,temperature:!0,maxOutputTokens:!0,topP:!0,topK:!0}).transform((function(e){var t,n,o,a,r,i,l;return s(s({},e),{model:null!==(t=e.model)&&void 0!==t?t:"claude-1",modelLabel:null!==(n=e.modelLabel)&&void 0!==n?n:null,promptPrefix:null!==(o=e.promptPrefix)&&void 0!==o?o:null,temperature:null!==(a=e.temperature)&&void 0!==a?a:1,maxOutputTokens:null!==(r=e.maxOutputTokens)&&void 0!==r?r:4e3,topP:null!==(i=e.topP)&&void 0!==i?i:.7,topK:null!==(l=e.topK)&&void 0!==l?l:5})})).catch((function(){return{model:"claude-1",modelLabel:null,promptPrefix:null,temperature:1,maxOutputTokens:4e3,topP:.7,topK:5}})),P.pick({model:!0}).transform((function(e){var t;return s(s({},e),{model:null!==(t=e.model)&&void 0!==t?t:"text-davinci-002-render-sha"})})).catch((function(){return{model:"text-davinci-002-render-sha"}})),P.pick({model:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,tools:!0,agentOptions:!0}).transform((function(e){var t,n,o,a,r,i,l,u,p;return s(s({},e),{model:null!==(t=e.model)&&void 0!==t?t:"gpt-3.5-turbo",chatGptLabel:null!==(n=e.chatGptLabel)&&void 0!==n?n:null,promptPrefix:null!==(o=e.promptPrefix)&&void 0!==o?o:null,temperature:null!==(a=e.temperature)&&void 0!==a?a:.8,top_p:null!==(r=e.top_p)&&void 0!==r?r:1,presence_penalty:null!==(i=e.presence_penalty)&&void 0!==i?i:0,frequency_penalty:null!==(l=e.frequency_penalty)&&void 0!==l?l:0,tools:null!==(u=e.tools)&&void 0!==u?u:[],agentOptions:null!==(p=e.agentOptions)&&void 0!==p?p:{agent:"functions",skipCompletion:!0,model:"gpt-3.5-turbo",temperature:0}})})).catch((function(){return{model:"gpt-3.5-turbo",chatGptLabel:null,promptPrefix:null,temperature:.8,top_p:1,presence_penalty:0,frequency_penalty:0,tools:[],agentOptions:{agent:"functions",skipCompletion:!0,model:"gpt-3.5-turbo",temperature:0}}})),P.pick({model:!0,assistant_id:!0,instructions:!0,promptPrefix:!0}).transform(k).catch((function(){return{}})),P.pick({model:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,resendImages:!0,imageDetail:!0}).transform((function(e){var t=s({},e);return"gpt-3.5-turbo"===t.model&&delete t.model,1===t.temperature&&delete t.temperature,1===t.top_p&&delete t.top_p,0===t.presence_penalty&&delete t.presence_penalty,0===t.frequency_penalty&&delete t.frequency_penalty,!0!==t.resendImages&&delete t.resendImages,t.imageDetail===d.auto&&delete t.imageDetail,k(t)})).catch((function(){return{}})),P.pick({model:!0,modelLabel:!0,promptPrefix:!0,examples:!0,temperature:!0,maxOutputTokens:!0,topP:!0,topK:!0}).transform((function(e){var t=s({},e);return t.model===f.model.default&&delete t.model,t.temperature===f.temperature.default&&delete t.temperature,t.maxOutputTokens===f.maxOutputTokens.default&&delete t.maxOutputTokens,t.topP===f.topP.default&&delete t.topP,t.topK===f.topK.default&&delete t.topK,k(t)})).catch((function(){return{}})),P.pick({model:!0,modelLabel:!0,promptPrefix:!0,temperature:!0,maxOutputTokens:!0,topP:!0,topK:!0}).transform((function(e){var t=s({},e);return"claude-1"===t.model&&delete t.model,1===t.temperature&&delete t.temperature,4e3===t.maxOutputTokens&&delete t.maxOutputTokens,.7===t.topP&&delete t.topP,5===t.topK&&delete t.topK,k(t)})).catch((function(){return{}})),P.pick({model:!0}).transform((function(e){var t=s({},e);return"text-davinci-002-render-sha"===t.model&&delete t.model,k(t)})).catch((function(){return{}})),P.pick({model:!0,chatGptLabel:!0,promptPrefix:!0,temperature:!0,top_p:!0,presence_penalty:!0,frequency_penalty:!0,tools:!0,agentOptions:!0}).transform((function(e){var t,n=s({},e);return"gpt-3.5-turbo"===n.model&&delete n.model,null===n.chatGptLabel&&delete n.chatGptLabel,null===n.promptPrefix&&delete n.promptPrefix,.8===n.temperature&&delete n.temperature,1===n.top_p&&delete n.top_p,0===n.presence_penalty&&delete n.presence_penalty,0===n.frequency_penalty&&delete n.frequency_penalty,0===(null===(t=n.tools)||void 0===t?void 0:t.length)&&delete n.tools,n.agentOptions&&"functions"===n.agentOptions.agent&&!0===n.agentOptions.skipCompletion&&"gpt-3.5-turbo"===n.agentOptions.model&&0===n.agentOptions.temperature&&delete n.agentOptions,k(n)})).catch((function(){return{}})),(O={})[l.openAI]=!0,O[l.google]=!0,O[l.assistants]=!0,O[l.azureOpenAI]=!0,O[l.custom]=!0;var _=["application/vnd.ms-excel","application/msexcel","application/x-msexcel","application/x-ms-excel","application/x-excel","application/x-dos_ms_excel","application/xls","application/x-xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];c(["text/x-c","text/x-c++","application/csv","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","image/jpeg","text/javascript","image/gif","image/png","application/x-tar","application/typescript","application/xml","application/zip"],_,!0),c(["text/x-c","text/x-c++","application/csv","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","image/jpeg","text/javascript","image/gif","image/png","application/x-tar","application/typescript","application/xml","application/zip"],_,!0);var w=/^image\/(jpeg|gif|png|webp)$/,A=[/^(text\/(x-c|x-c\+\+|x-java|html|markdown|x-php|x-python|x-script\.python|x-ruby|x-tex|plain|css|javascript|csv))$/,/^application\/(vnd\.ms-excel|msexcel|x-msexcel|x-ms-excel|x-excel|x-dos_ms_excel|xls|x-xls|vnd\.openxmlformats-officedocument\.spreadsheetml\.sheet)$/,/^(application\/(csv|json|pdf|x-tar|typescript|vnd\.openxmlformats-officedocument\.(wordprocessingml\.document|presentationml\.presentation|spreadsheetml\.sheet)|xml|zip))$/,w],S=function(e){return 1048576*e};(I={})[l.assistants]={fileLimit:10,fileSizeLimit:S(512),totalSizeLimit:S(512),supportedMimeTypes:A,disabled:!1},I.default={fileLimit:10,fileSizeLimit:S(20),totalSizeLimit:S(25),supportedMimeTypes:[w],disabled:!1},S(512),S(2);var T,C,j,L,E,G,M,R=o.array(o.any()).optional().refine((function(e){return!e||e.every((function(e){return e instanceof RegExp||"string"==typeof e}))}),{message:"Each mimeType must be a string or a RegExp object."}),K=o.object({disabled:o.boolean().optional(),fileLimit:o.number().min(0).optional(),fileSizeLimit:o.number().min(0).optional(),totalSizeLimit:o.number().min(0).optional(),supportedMimeTypes:R.optional()}),Q=o.object({endpoints:o.record(K).optional(),serverFileSizeLimit:o.number().min(0).optional(),avatarSizeLimit:o.number().min(0).optional()});!function(e){e.local="local",e.firebase="firebase",e.openai="openai",e.s3="s3"}(T||(T={})),function(e){e.avatar="avatar",e.unknown="unknown",e.assistants="assistants",e.image_generation="image_generation",e.assistants_output="assistants_output",e.message_attachment="message_attachment"}(C||(C={}));var D,N,z,F,q,U,W=o.nativeEnum(T),B=o.object({disableBuilder:o.boolean().optional(),pollIntervalMs:o.number().optional(),timeoutMs:o.number().optional(),supportedIds:o.array(o.string()).min(1).optional(),excludedIds:o.array(o.string()).min(1).optional(),apiKey:o.string().optional(),baseURL:o.string().optional(),models:o.object({default:o.array(o.string()).min(1),fetch:o.boolean().optional(),userIdQuery:o.boolean().optional()}).optional(),titleConvo:o.boolean().optional(),titleMethod:o.union([o.literal("completion"),o.literal("functions")]).optional(),titleModel:o.string().optional(),headers:o.record(o.any()).optional()}),V=o.object({name:o.string().refine((function(e){return!m.safeParse(e).success}),{message:"Value cannot be one of the default endpoint (EModelEndpoint) values: ".concat(Object.values(l).join(", "))}),apiKey:o.string(),baseURL:o.string(),models:o.object({default:o.array(o.string()).min(1),fetch:o.boolean().optional(),userIdQuery:o.boolean().optional()}),titleConvo:o.boolean().optional(),titleMethod:o.union([o.literal("completion"),o.literal("functions")]).optional(),titleModel:o.string().optional(),summarize:o.boolean().optional(),summaryModel:o.string().optional(),forcePrompt:o.boolean().optional(),modelDisplayLabel:o.string().optional(),headers:o.record(o.any()).optional(),addParams:o.record(o.any()).optional(),dropParams:o.array(o.string()).optional()}),Y=o.object({fileUploads:o.object({ipMax:o.number().optional(),ipWindowInMinutes:o.number().optional(),userMax:o.number().optional(),userWindowInMinutes:o.number().optional()}).optional()});o.object({version:o.string(),cache:o.boolean(),fileStrategy:W.optional(),registration:o.object({socialLogins:o.array(o.string()).optional(),allowedDomains:o.array(o.string()).optional()}).optional(),rateLimits:Y.optional(),fileConfig:Q.optional(),endpoints:o.object((j={},j[l.assistants]=B.optional(),j.custom=o.array(V.partial()).optional(),j)).strict().refine((function(e){return Object.keys(e).length>0}),{message:"At least one `endpoints` field must be provided."}).optional()}),function(e){e.mistral="mistral",e.openrouter="openrouter"}(D||(D={})),l.openAI,l.assistants,l.azureOpenAI,l.bingAI,l.chatGPTBrowser,l.gptPlugins,l.google,l.anthropic,l.custom,(L={})[l.openAI]="OpenAI",L[l.assistants]="Assistants",L[l.azureOpenAI]="Azure OpenAI",L[l.bingAI]="IntelliumGPT",L[l.chatGPTBrowser]="ChatGPT",L[l.gptPlugins]="Plugins",L[l.google]="Google",L[l.anthropic]="Anthropic",L[l.custom]="Custom",(E={})[l.assistants]=["gpt-3.5-turbo-0125","gpt-4-0125-preview","gpt-4-turbo-preview","gpt-4-1106-preview","gpt-3.5-turbo-1106","gpt-3.5-turbo-16k-0613","gpt-3.5-turbo-16k","gpt-3.5-turbo","gpt-4","gpt-4-0314","gpt-4-32k-0314","gpt-4-0613","gpt-3.5-turbo-0613"],E[l.google]=["gemini-pro","gemini-pro-vision","chat-bison","chat-bison-32k","codechat-bison","codechat-bison-32k","text-bison","text-bison-32k","text-unicorn","code-gecko","code-bison","code-bison-32k"],E[l.anthropic]=["claude-2.1","claude-2","claude-1.2","claude-1","claude-1-100k","claude-instant-1","claude-instant-1-100k"],E[l.openAI]=["gpt-3.5-turbo-0125","gpt-3.5-turbo-16k-0613","gpt-3.5-turbo-16k","gpt-4-turbo-preview","gpt-4-0125-preview","gpt-4-1106-preview","gpt-3.5-turbo","gpt-3.5-turbo-1106","gpt-4-vision-preview","gpt-4","gpt-3.5-turbo-instruct-0914","gpt-3.5-turbo-0613","gpt-3.5-turbo-0301","gpt-3.5-turbo-instruct","gpt-4-0613","text-davinci-003","gpt-4-0314"],(G={})[l.openAI]="/api/ask/".concat(l.openAI),G[l.bingAI]="/api/ask/".concat(l.bingAI),G[l.google]="/api/ask/".concat(l.google),G[l.custom]="/api/ask/".concat(l.custom),G[l.anthropic]="/api/ask/".concat(l.anthropic),G[l.gptPlugins]="/api/ask/".concat(l.gptPlugins),G[l.azureOpenAI]="/api/ask/".concat(l.azureOpenAI),G[l.chatGPTBrowser]="/api/ask/".concat(l.chatGPTBrowser),G[l.assistants]="/api/assistants/chat",new Set([l.gptPlugins,l.anthropic,l.google,l.openAI,l.azureOpenAI,l.custom]),(M={})[l.openAI]=!0,M[l.azureOpenAI]=!0,M[l.gptPlugins]=!0,M[l.custom]=!0,function(e){e.CONFIG_STORE="configStore",e.PLUGINS="plugins",e.GEN_TITLE="genTitle",e.TOOLS="tools",e.MODELS_CONFIG="modelsConfig",e.MODEL_QUERIES="modelQueries",e.ENDPOINT_CONFIG="endpointsConfig",e.TOKEN_CONFIG="tokenConfig",e.CUSTOM_CONFIG="customConfig",e.ABORT_KEYS="abortKeys",e.OVERRIDE_CONFIG="overrideConfig",e.FILE_UPLOAD_LIMIT="file_upload_limit"}(N||(N={})),function(e){e.GOOGLE_SERVICE_KEY="GOOGLE_SERVICE_KEY",e.GOOGLE_API_KEY="GOOGLE_API_KEY"}(z||(z={})),function(e){e[e.LOW=85]="LOW",e[e.HIGH=170]="HIGH",e[e.ADDITIONAL=85]="ADDITIONAL"}(F||(F={})),function(e){e.GENERAL="general",e.BETA="beta",e.DATA="data",e.ACCOUNT="account"}(q||(q={})),function(e){e.VERSION="v0.6.10",e.CONFIG_VERSION="1.0.3",e.NO_PARENT="00000000-0000-0000-0000-000000000000"}(U||(U={}));var H={order:"asc"};var $=function(e,t){return"/api/messages/".concat(e).concat(t?"/".concat(t):"")},J="/api/keys",X=function(e,t){return"/api/search?q=".concat(e,"&pageNumber=").concat(t)};function Z(e,t){return u(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,a.post(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))}var ee=!1,te=[],ne=function(e){return Z(function(e){return"/api/auth/refresh".concat(e?"?retry=true":"")}(e))},oe=function(e,t){void 0===t&&(t=null),te.forEach((function(n){e?n.reject(e):n.resolve(t)})),te=[]};a.interceptors.response.use((function(e){return e}),(function(e){return u(void 0,void 0,void 0,(function(){var t,n,o,r,i;return p(this,(function(l){switch(l.label){case 0:if(t=e.config,401!==e.response.status||t._retry)return[3,13];if(t._retry=!0,!ee)return[3,5];l.label=1;case 1:return l.trys.push([1,4,,5]),[4,new Promise((function(e,t){te.push({resolve:e,reject:t})}))];case 2:return o=l.sent(),t.headers.Authorization="Bearer "+o,[4,a(t)];case 3:return[2,l.sent()];case 4:return n=l.sent(),[2,Promise.reject(n)];case 5:ee=!0,l.label=6;case 6:return l.trys.push([6,11,12,13]),[4,ne(!!(null===(i=t.url)||void 0===i?void 0:i.includes("api/auth/refresh")))];case 7:return(o=l.sent().token)?(t.headers.Authorization="Bearer "+o,function(e){a.defaults.headers.common.Authorization="Bearer "+e}(o),window.dispatchEvent(new CustomEvent("tokenUpdated",{detail:o})),oe(null,o),[4,a(t)]):[3,9];case 8:return[2,l.sent()];case 9:window.location.href="/login",l.label=10;case 10:return[3,13];case 11:return r=l.sent(),oe(r,null),[2,Promise.reject(r)];case 12:return ee=!1,[7];case 13:return[2,Promise.reject(e)]}}))}))}));var ae={get:function(e,t){return u(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,a.get(e,s({},t))];case 1:return[2,n.sent().data]}}))}))},post:Z,postMultiPart:function(e,t,n){return u(this,void 0,void 0,(function(){return p(this,(function(o){switch(o.label){case 0:return[4,a.post(e,t,s(s({},n),{headers:{"Content-Type":"multipart/form-data"}}))];case 1:return[2,o.sent().data]}}))}))},put:function(e,t){return u(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,a.put(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))},delete:function(e){return u(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return[4,a.delete(e)];case 1:return[2,t.sent().data]}}))}))},deleteWithOptions:function(e,t){return u(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,a.delete(e,s({},t))];case 1:return[2,n.sent().data]}}))}))},patch:function(e,t){return u(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,a.patch(e,JSON.stringify(t),{headers:{"Content-Type":"application/json"}})];case 1:return[2,n.sent().data]}}))}))},refreshToken:ne};function re(e){return ae.delete(function(e){return"".concat(J,"/").concat(e)}(e))}function ie(){return ae.delete("".concat(J,"?all=true"))}function le(e){return ae.get(function(e){return"/api/convos/".concat(e)}(e))}function se(e){if(!e.value)throw new Error("value is required");return ae.put(J,e)}var ue,pe,ce=function(e){return ae.get(function(e){return"".concat(J,"?name=").concat(e)}(e))};!function(e){e.messages="messages",e.allConversations="allConversations",e.searchConversations="searchConversations",e.conversation="conversation",e.searchEnabled="searchEnabled",e.user="user",e.name="name",e.models="models",e.balance="balance",e.endpoints="endpoints",e.presets="presets",e.searchResults="searchResults",e.tokenCount="tokenCount",e.availablePlugins="availablePlugins",e.startupConfig="startupConfig",e.assistants="assistants",e.assistant="assistant",e.endpointsConfigOverride="endpointsConfigOverride",e.files="files",e.fileConfig="fileConfig",e.tools="tools",e.actions="actions",e.assistantDocs="assistantDocs"}(ue||(ue={})),function(e){e.fileUpload="fileUpload",e.fileDelete="fileDelete",e.updatePreset="updatePreset",e.deletePreset="deletePreset",e.logoutUser="logoutUser",e.avatarUpload="avatarUpload",e.assistantAvatarUpload="assistantAvatarUpload",e.updateAction="updateAction",e.deleteAction="deleteAction"}(pe||(pe={}));var de=function(){var n=e();return t((function(e){return function(e,t,n){return ae.post(function(e){return"/api/ask/".concat(e,"/abort")}(e),{arg:{abortKey:t,message:n}})}(e.endpoint,e.abortKey,e.message)}),{onSuccess:function(){n.invalidateQueries([ue.balance])}})},fe=function(e){return n([ue.user],(function(){return ae.get("/api/user")}),s({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1},e))},me=function(e,t){return n([ue.messages,e],(function(){return"new"===(t=e)?Promise.resolve([]):ae.get($(t));var t}),s({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},t))},ge=function(e){return n([ue.balance],(function(){return ae.get("/api/balance")}),s({refetchOnWindowFocus:!0,refetchOnReconnect:!0,refetchOnMount:!0},e))},ve=function(e,t){return n([ue.conversation,e],(function(){return le(e)}),s({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},t))},be=function(n){var o=e();return t((function(){return le(n)}),{onSuccess:function(){o.invalidateQueries([ue.conversation,n])}})},he=function(n){var o=e();return t((function(e){return function(e){var t=e.conversationId,n=e.messageId,o=e.text;if(!t)throw new Error("conversationId is required");return ae.put($(t,n),{text:o})}(e)}),{onSuccess:function(){o.invalidateQueries([ue.messages,n])}})},xe=function(){var n=e();return t((function(e){return se(e)}),{onSuccess:function(){n.invalidateQueries([ue.name])}})},ye=function(){var n=e();return t((function(){return ae.post("/api/convos/clear",{arg:{}})}),{onSuccess:function(){n.invalidateQueries([ue.allConversations])}})},Oe=function(n){var o=e();return t((function(){return re(n)}),{onSuccess:function(){o.invalidateQueries([ue.name]),n===l.assistants&&(o.invalidateQueries([ue.assistants,H]),o.invalidateQueries([ue.assistantDocs]),o.invalidateQueries([ue.assistants]),o.invalidateQueries([ue.assistant]),o.invalidateQueries([ue.actions]),o.invalidateQueries([ue.tools]))}})},Ie=function(){var n=e();return t((function(){return ie()}),{onSuccess:function(){n.invalidateQueries([ue.name]),n.invalidateQueries([ue.assistants,H]),n.invalidateQueries([ue.assistantDocs]),n.invalidateQueries([ue.assistants]),n.invalidateQueries([ue.assistant]),n.invalidateQueries([ue.actions]),n.invalidateQueries([ue.tools])}})},Pe=function(e,t){return n([ue.allConversations],(function(){return function(e){return ae.get(function(e){return"/api/convos?pageNumber=".concat(e)}(e))}(e)}),s({refetchOnReconnect:!1,refetchOnMount:!1,retry:1},t))},ke=function(e){return n([ue.searchEnabled],(function(){return ae.get("/api/search/enable")}),s({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},e))},_e=function(e){return n([ue.endpoints],(function(){return ae.get("/api/endpoints")}),s({staleTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},e))},we=function(e){return n([ue.models],(function(){return u(void 0,void 0,void 0,(function(){return p(this,(function(e){return[2,ae.get("/api/models")]}))}))}),s({staleTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},e))},Ae=function(){var n=e();return t((function(e){return function(e){return ae.post("/api/presets",e)}(e)}),{onSuccess:function(){n.invalidateQueries([ue.presets])}})},Se=function(){var n=e();return t((function(e){return t=e,ae.post("/api/presets/delete",t);var t}),{onSuccess:function(){n.invalidateQueries([ue.presets])}})},Te=function(e,t,o){return n([ue.searchResults,t,e],(function(){return function(e,t){return u(void 0,void 0,void 0,(function(){return p(this,(function(n){return[2,ae.get(X(e,t))]}))}))}(e,t)}),s({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1},o))},Ce=function(){var n=e();return t((function(e){return function(e){return ae.post("/api/tokenizer",{arg:e})}(e.text)}),{onSuccess:function(){n.invalidateQueries([ue.tokenCount])}})},je=function(){var n=e();return t((function(e){return function(e){return ae.post("/api/auth/login",e)}(e)}),{onMutate:function(){n.removeQueries(),localStorage.removeItem("lastConversationSetup"),localStorage.removeItem("lastSelectedModel"),localStorage.removeItem("lastSelectedTools"),localStorage.removeItem("filesToDelete")}})},Le=function(){var n=e();return t((function(e){return function(e){return ae.post("/api/auth/register",e)}(e)}),{onSuccess:function(){n.invalidateQueries([ue.user])}})},Ee=function(){var n=e();return t((function(){return ae.refreshToken()}),{onMutate:function(){n.removeQueries()}})},Ge=function(e,t){return n([ue.name,e],(function(){return e?ce(e):Promise.resolve({expiresAt:""})}),s({refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1},t))},Me=function(){return t((function(e){return function(e){return ae.post("/api/auth/requestPasswordReset",e)}(e)}))},Re=function(){return t((function(e){return function(e){return ae.post("/api/auth/resetPassword",e)}(e)}))},Ke=function(){return n([ue.availablePlugins],(function(){return ae.get("/api/plugins")}),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1})},Qe=function(){var n=e();return t((function(e){return function(e){return ae.post("/api/user/plugins",e)}(e)}),{onSuccess:function(){n.invalidateQueries([ue.user])}})},De=function(){return n([ue.startupConfig],(function(){return ae.get("/api/config")}),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1})};export{de as useAbortRequestWithMessage,Ke as useAvailablePluginsQuery,ye as useClearConversationsMutation,Ae as useCreatePresetMutation,Se as useDeletePresetMutation,be as useGetConversationByIdMutation,ve as useGetConversationByIdQuery,Pe as useGetConversationsQuery,_e as useGetEndpointsQuery,me as useGetMessagesByConvoId,we as useGetModelsQuery,ke as useGetSearchEnabledQuery,De as useGetStartupConfig,ge as useGetUserBalance,fe as useGetUserQuery,je as useLoginUserMutation,Ee as useRefreshTokenMutation,Le as useRegisterUserMutation,Me as useRequestPasswordResetMutation,Re as useResetPasswordMutation,Ie as useRevokeAllUserKeysMutation,Oe as useRevokeUserKeyMutation,Te as useSearchQuery,he as useUpdateMessageMutation,Ce as useUpdateTokenCountMutation,xe as useUpdateUserKeysMutation,Qe as useUpdateUserPluginsMutation,Ge as useUserKeyQuery};
//# sourceMappingURL=index.es.js.map
